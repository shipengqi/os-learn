<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="SSH # SSH（Secure Shell）是一种网络协议，用于加密两台计算机之间的通信，并且支持各种身份验证机制。主要用于服务器登录和各种加密通信。
历史上，网络主机之间的通信是不加密的，属于明文通信。这使得通信很不安全。SSH 就是为了解决这个问题而诞生的。
SSH 的软件架构是服务器-客户端模式（Server - Client）。
SSH 客户端 # 基本用法：
# 不指定用户名，使用客户端的当前用户名，作为远程服务器的登录用户名 $ ssh hostname # 指定用户名 $ ssh user@hostname # -l 参数，用户名和主机名可以分开 $ ssh -l username host # -p 指定端口，默认连接服务器的 22 端口 $ ssh -p 8821 foo.com # 连接服务器，并立刻执行 command，非交互模式 ssh username@hostname command 客户端连接流程 # ssh 连接远程服务器，如果是第一次连接某一台服务器，会出现下面的提示：
The authenticity of host '16.187.189.94 (16.187.189.94)' can't be established. ECDSA key fingerprint is SHA256:Vybt22mVXuNuB5unE++yowF7lgA/9/2bLSiO3qmYWBY. Are you sure you want to continue connecting (yes/no)?"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:title" content="SSH"><meta property="og:description" content="SSH # SSH（Secure Shell）是一种网络协议，用于加密两台计算机之间的通信，并且支持各种身份验证机制。主要用于服务器登录和各种加密通信。
历史上，网络主机之间的通信是不加密的，属于明文通信。这使得通信很不安全。SSH 就是为了解决这个问题而诞生的。
SSH 的软件架构是服务器-客户端模式（Server - Client）。
SSH 客户端 # 基本用法：
# 不指定用户名，使用客户端的当前用户名，作为远程服务器的登录用户名 $ ssh hostname # 指定用户名 $ ssh user@hostname # -l 参数，用户名和主机名可以分开 $ ssh -l username host # -p 指定端口，默认连接服务器的 22 端口 $ ssh -p 8821 foo.com # 连接服务器，并立刻执行 command，非交互模式 ssh username@hostname command 客户端连接流程 # ssh 连接远程服务器，如果是第一次连接某一台服务器，会出现下面的提示：
The authenticity of host '16.187.189.94 (16.187.189.94)' can't be established. ECDSA key fingerprint is SHA256:Vybt22mVXuNuB5unE++yowF7lgA/9/2bLSiO3qmYWBY. Are you sure you want to continue connecting (yes/no)?"><meta property="og:type" content="article"><meta property="og:url" content="http://shipengqi.github.io/os-learn/docs/commands/18_ssh/"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2024-09-12T14:32:13+08:00"><title>SSH | OS Learning</title><link rel=manifest href=/os-learn/manifest.json><link rel=icon href=/os-learn/favicon.png><link rel=stylesheet href=/os-learn/book.min.33a48f5432973b8ff9a82679d9e45d67f2c15d4399bd2829269455cfe390b5e8.css integrity="sha256-M6SPVDKXO4/5qCZ52eRdZ/LBXUOZvSgpJpRVz+OQteg=" crossorigin=anonymous><script defer src=/os-learn/flexsearch.min.js></script>
<script defer src=/os-learn/en.search.min.5f5ef0e9793825f8025486a61037897ed49846ad920cbcaa8d00a88521c2d5ef.js integrity="sha256-X17w6Xk4JfgCVIamEDeJftSYRq2SDLyqjQCohSHC1e8=" crossorigin=anonymous></script>
<script defer src=/os-learn/sw.min.73e4e12d3b3ff9b5bd6410a479234d8908ebac0e4d11ef31f508715b8e7f7c7d.js integrity="sha256-c+ThLTs/+bW9ZBCkeSNNiQjrrA5NEe8x9QhxW45/fH0=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/os-learn/><span>OS Learning</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=https://shipengqi.github.io/ target=_blank rel=noopener>Blog</a></li><li><a href=https://github.com/shipengqi/os-learn target=_blank rel=noopener>Github</a></li></ul><ul><li><span>Linux 常用命令</span><ul><li><a href=/os-learn/docs/commands/01_view_text/>查看文件内容</a></li><li><a href=/os-learn/docs/commands/02_tar/>打包压缩</a></li><li><a href=/os-learn/docs/commands/03_vim/>vim</a></li><li><a href=/os-learn/docs/commands/04_user_manage/>用户管理</a></li><li><a href=/os-learn/docs/commands/05_file_perm/>文件权限</a></li><li><a href=/os-learn/docs/commands/06_network/>网络管理</a></li><li><a href=/os-learn/docs/commands/07_package_manage/>包管理器</a></li><li><a href=/os-learn/docs/commands/08_grup/>grup</a></li><li><a href=/os-learn/docs/commands/09_process/>进程管理</a></li><li><a href=/os-learn/docs/commands/10_systemd/>systemctl</a></li><li><a href=/os-learn/docs/commands/11_selinux/>SELinux</a></li><li><a href=/os-learn/docs/commands/12_mem_disk/>内存和磁盘</a></li><li><a href=/os-learn/docs/commands/13_sar/>查看系统状态</a></li><li><a href=/os-learn/docs/commands/14_shell/>Shell</a></li><li><a href=/os-learn/docs/commands/15_script_priority/>脚本控制</a></li><li><a href=/os-learn/docs/commands/16_text_operation/>操作文本</a></li><li><a href=/os-learn/docs/commands/17_firewall/>防火墙</a></li><li><a href=/os-learn/docs/commands/18_ssh/ class=active>SSH</a></li><li><a href=/os-learn/docs/commands/19_ftp/>FTP</a></li><li><a href=/os-learn/docs/commands/20_nfs/>NFS</a></li><li><a href=/os-learn/docs/commands/21_dns/>DNS</a></li><li><a href=/os-learn/docs/commands/22_kernel_upgrade/>内核升级</a></li><li><a href=/os-learn/docs/commands/23_pty_tty/>pty</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/os-learn/svg/menu.svg class=book-icon alt=Menu></label>
<strong>SSH</strong>
<label for=toc-control><img src=/os-learn/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#ssh>SSH</a><ul><li><a href=#ssh-客户端>SSH 客户端</a><ul><li><a href=#客户端连接流程>客户端连接流程</a></li><li><a href=#服务器密钥变更>服务器密钥变更</a></li><li><a href=#配置文件>配置文件</a></li></ul></li><li><a href=#密钥登录>密钥登录</a><ul><li><a href=#ssh-agent>ssh-agent</a></li></ul></li><li><a href=#ssh-服务器>SSH 服务器</a><ul><li><a href=#配置文件-1>配置文件</a></li></ul></li><li><a href=#scp-和-sftp>scp 和 sftp</a><ul><li><a href=#scp>scp</a></li><li><a href=#sftp>sftp</a></li></ul></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=ssh>SSH
<a class=anchor href=#ssh>#</a></h1><p>SSH（Secure Shell）是一种网络协议，用于加密两台计算机之间的通信，并且支持各种身份验证机制。主要用于服务器登录和各种加密通信。</p><p>历史上，网络主机之间的通信是不加密的，属于明文通信。这使得通信很不安全。SSH 就是为了解决这个问题而诞生的。</p><p>SSH 的软件架构是服务器-客户端模式（Server - Client）。</p><h2 id=ssh-客户端>SSH 客户端
<a class=anchor href=#ssh-%e5%ae%a2%e6%88%b7%e7%ab%af>#</a></h2><p>基本用法：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 不指定用户名，使用客户端的当前用户名，作为远程服务器的登录用户名</span>
</span></span><span style=display:flex><span>$ ssh hostname
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 指定用户名</span>
</span></span><span style=display:flex><span>$ ssh user@hostname
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># -l 参数，用户名和主机名可以分开</span>
</span></span><span style=display:flex><span>$ ssh -l username host
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># -p 指定端口，默认连接服务器的 22 端口</span>
</span></span><span style=display:flex><span>$ ssh -p <span style=color:#ae81ff>8821</span> foo.com
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 连接服务器，并立刻执行 command，非交互模式</span>
</span></span><span style=display:flex><span>ssh username@hostname command
</span></span></code></pre></div><h3 id=客户端连接流程>客户端连接流程
<a class=anchor href=#%e5%ae%a2%e6%88%b7%e7%ab%af%e8%bf%9e%e6%8e%a5%e6%b5%81%e7%a8%8b>#</a></h3><p>ssh 连接远程服务器，如果是第一次连接某一台服务器，会出现下面的提示：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>The authenticity of host <span style=color:#e6db74>&#39;16.187.189.94 (16.187.189.94)&#39;</span> can<span style=color:#960050;background-color:#1e0010>&#39;</span>t be established.
</span></span><span style=display:flex><span>ECDSA key fingerprint is SHA256:Vybt22mVXuNuB5unE++yowF7lgA/9/2bLSiO3qmYWBY.
</span></span><span style=display:flex><span>Are you sure you want to <span style=color:#66d9ef>continue</span> connecting <span style=color:#f92672>(</span>yes/no<span style=color:#f92672>)</span>?
</span></span></code></pre></div><p>表示不认识 <code>16.187.189.94</code> 这台服务器的指纹，确认是否需要连接。<strong>服务器指纹</strong> 指的是 SSH 服务器公钥的哈希值。</p><p>查看公钥的指纹，可以使用命令：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ssh-keygen -l -f /etc/ssh/ssh_host_ecdsa_key.pub
</span></span><span style=display:flex><span><span style=color:#ae81ff>256</span> Vybt22mVXuNuB5unE++yowF7lgA/9/2bLSiO3qmYWBY   <span style=color:#f92672>(</span>ECDSA<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>输入 <code>yes</code>，客户端会将服务器的公钥指纹储存在本机的 <code>~/.ssh/known_hosts</code> 文件中。每次连接服务器时，通过该文件判断是否为陌生主机。</p><p>建立连接后，输入用户名密码就可以登录了。</p><h3 id=服务器密钥变更>服务器密钥变更
<a class=anchor href=#%e6%9c%8d%e5%8a%a1%e5%99%a8%e5%af%86%e9%92%a5%e5%8f%98%e6%9b%b4>#</a></h3><p>服务器指纹可以防止有人恶意冒充远程主机。如果服务器的密钥发生变更（比如重装了 SSH 服务器），客户端再次连接时，发现公钥指纹不匹配，会显示一段警告信息：</p><pre tabindex=0><code>@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@    WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!     @
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!
Someone could be eavesdropping on you right now (man-in-the-middle attack)!
It is also possible that the RSA host key has just been changed.
The fingerprint for the RSA key sent by the remote host is
77:a5:69:81:9b:eb:40:76:7b:13:04:a9:6c:f4:9c:5d.
Please contact your system administrator.
Add correct host key in /home/me/.ssh/known_hosts to get rid of this message.
Offending key in /home/me/.ssh/known_hosts:36
</code></pre><p>表示公钥指纹和 <code>~/.ssh/known_hosts</code> 文件储存的不一样。如果要信任新的公钥，可以使用命令，将原来的公钥指纹从 <code>~/.ssh/known_hosts</code> 文件删除：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ssh-keygen -R hostname
</span></span></code></pre></div><p>也可以手动从 <code>~/.ssh/known_hosts</code> 文件中删除。</p><p>删除以后，重新连接就可以了。</p><h3 id=配置文件>配置文件
<a class=anchor href=#%e9%85%8d%e7%bd%ae%e6%96%87%e4%bb%b6>#</a></h3><p>SSH 客户端的全局配置文件是 <code>/etc/ssh/ssh_config</code>，用户个人的配置文件在 <code>~/.ssh/config</code>，优先级高于全局配置文件。</p><h2 id=密钥登录>密钥登录
<a class=anchor href=#%e5%af%86%e9%92%a5%e7%99%bb%e5%bd%95>#</a></h2><p>SSH 默认使用密码登录，每次都必须输入密码，不安全也麻烦。可以通过密钥登录。</p><p>SSH 密钥登录采用的是非对称加密，私钥必须私密保存，不能泄漏；公钥则是公开的，可以对外发送。如果数据使用公钥加密，那么只有使用对应的私钥才能解密；如果使用私钥加密（这个过程一般称为“签名”），也只有使用对应的公钥解密。</p><p>密钥登录过程：</p><ol><li>用户将自己的公钥储存在远程主机上的指定位置。</li><li>用户登录的时候，远程主机会向用户发送一段随机字符串。</li><li>用户收到随机字符串，用自己的私钥对随机串加密（签名）后，再发给远程主机。</li><li>远程主机收到客户端发来的加密签名后，用事先储存的公钥进行解密，然后跟原始数据比较。如果一致，就允许用户登录。</li></ol><p>用户可以使用 <code>ssh-keygen</code> 密钥对，生成时可以对私钥设置口令（passphrase）。一般密钥对会放在 <code>$HOME/.ssh/</code> 目录下，会新生成两个文件：<code>id_rsa.pub</code> 和 <code>id_rsa</code>。前者是公钥，后者是私钥。</p><p>将公钥传送到远程主机上面：</p><ol><li>查看是否存在 <code>$HOME/.ssh/authorized_keys</code> 文件，不存在则创建该文件：</li><li>将生成的 <code>id_rsa.pub</code> 文件内容粘贴到 <code>authorized_keys</code> 文件。</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@SGDLITVM0905 .ssh<span style=color:#f92672>]</span><span style=color:#75715e># cat authorized_keys</span>
</span></span><span style=display:flex><span>ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDaA4G5QBf3IgoA4+4iB8P2JLshyidbUZ4g4NRhMc0T5t7+LHjitnixtfoufDIFUsX3iiJqj/E53vuYtmPZdB9J+V6LMG1Ld2tPFnnzF8/7Xb+IcYLmpkBxFdH30XpuI4Kbt8nZROhTtpQ6/Hj4RLhvYbuR5xNeBkRZQoST2SwP9BzPnCPZCm4Z0X00/ol61hD9n3lEoa7riAUwzS6Sa+8wNjxf1srUJvvAk6URvN1qGZhJGAG2z+fuYcJOlggZ+fTbLOqaY+JZ/m3CSzZ7Yvl44D3JgqkFBQiBaZGvhg3reaOGxv6KrAd+gIR8QiOekZUzP7LWevthe2mYaYDDVxc9
</span></span><span style=display:flex><span>ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCbsQz/ePcNnIb7K3DHaULVRwa/GE6wxTqWSCzMzM4tVYlwfJo0bMti4qjsrJz2IVb9lH6Sfu69brr7yHRgcaeCNPKlDtrhH1bxzu4ayjoimcibeKrOfZu6qCJH+JxfwxC9eW6xQDu+Z6xigny19miSd3PhDqHloz4GZKRa2X1fPxB//F+NYuTZJvafjKCZ8eIXcjr0R53tpxdkhKpYIQ4rd8uPtZPjidrEUQcukmngG/LPhoJ6ebQ1zOmSPtXP3kVLATrrlQRWZlHqSbFJpnJHclhN8NgahtyR7ad63suHxBKLAa71QjNvSRfa0QUQ4/uqH9zBT5hbGd1IXSA3Sq1l root@shcAimeeCOS72.hpeswlab.net
</span></span><span style=display:flex><span>ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCaDa+Nl8NK7bagAp9vbuKQyh00y6UHOdNiugwc6Mcw7qsCPpV257LZDLHyrXjdQpqFy135AZTUPGozPh8TH/W6sI8jWgCl9+mYup7+/i1wwjIxnkppKV7nqrWVxEXt5LLny7M0+HCw4pC9jUlFGC5MZVV6mVyI8oTeRkZddrja0c/65Et0+ksiiT2A4yIDoKFslv5vDAYolRJx13a4ESWjsCpGQOvrxtsQqpISm0yaZO8Ha+1a6tjniEWReZNGcOajrLP4V+lv8Qi0Cl/iNIkpD+fnRFphY6RgYC5UrLFYOBCgaKgQhUBK2BOcjM1dR1IqCV9YRv+N4PLhmLweyvQJ root@autovmCOS76VM09.hpeswlab.net
</span></span></code></pre></div><p>然后再登录，就不需要输入密码了。</p><p>ssh 也提供了命令来拷贝公钥，<code>ssh-copy-id</code>：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># -i 指定公钥文件，拷贝到对应的账户下的 authorized_keys 文件中</span>
</span></span><span style=display:flex><span>ssh-copy-id -i ~/.ssh/id_rsa.pub root@16.187.189.94
</span></span></code></pre></div><p>如果不能登录，检查远程主机的 <code>/etc/ssh/sshd_config</code> 文件，去掉如下三行注释：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#75715e>#RSAAuthentication yes</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#PubkeyAuthentication yes</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#AuthorizedKeysFile     .ssh/authorized_keys</span>
</span></span></code></pre></div><p>重启 sshd 服务：<code>systemctl restart sshd</code>。</p><h3 id=ssh-agent>ssh-agent
<a class=anchor href=#ssh-agent>#</a></h3><p>私钥设置了密码以后，每次使用都必须输入密码，非常麻烦。<code>ssh-agent</code> 命令就是为了解决这个问题，它让用户在整个 Bash 对话（session）之中，只在第一次使用 SSH 命令时输入密码，然后将私钥保存在内存中，后面都不需要再输入私钥的密码了。</p><p>使用步骤：</p><p>第一步，新建一个命令行对话：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># bash 可以换成 zsh，fish 等</span>
</span></span><span style=display:flex><span>$ ssh-agent bash
</span></span></code></pre></div><p>也可以在当前对话启用 <code>ssh-agent</code>：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ eval <span style=color:#e6db74>`</span>ssh-agent<span style=color:#e6db74>`</span>
</span></span></code></pre></div><p>第二步，在新建的 Shell 对话里面，使用 <code>ssh-add</code> 命令添加默认的私钥：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 添加默认的私钥</span>
</span></span><span style=display:flex><span>$ ssh-add
</span></span><span style=display:flex><span>Enter passphrase <span style=color:#66d9ef>for</span> /home/you/.ssh/id_dsa: ********
</span></span><span style=display:flex><span>Identity added: /home/you/.ssh/id_dsa <span style=color:#f92672>(</span>/home/you/.ssh/id_dsa<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 添加指定的私钥</span>
</span></span><span style=display:flex><span>$ ssh-add other-key-file 
</span></span></code></pre></div><p>添加私钥时，要输入密码，之后在这个会话中，就不再需要输入私钥密码了。</p><p>第三步，使用 ssh 命令正常登录远程服务器。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ssh hostname
</span></span></code></pre></div><p>退出 <code>ssh-agent</code>：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ssh-agent -k
</span></span></code></pre></div><p>也可以直接关闭 shell 会话。</p><h2 id=ssh-服务器>SSH 服务器
<a class=anchor href=#ssh-%e6%9c%8d%e5%8a%a1%e5%99%a8>#</a></h2><h3 id=配置文件-1>配置文件
<a class=anchor href=#%e9%85%8d%e7%bd%ae%e6%96%87%e4%bb%b6-1>#</a></h3><p>服务端配置文件 <code>/etc/ssh/sshd_config</code>。</p><p>每行都是配置项和对应的值，配置项的大小写不敏感，与值之间使用空格分隔。注释只能放在一行的开头，不能放在一行的结尾。</p><h2 id=scp-和-sftp>scp 和 sftp
<a class=anchor href=#scp-%e5%92%8c-sftp>#</a></h2><h3 id=scp>scp
<a class=anchor href=#scp>#</a></h3><p>scp（secure copy），是 SSH 提供的一个客户端程序，用来在两台主机之间加密传送文件。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 本地文件复制到远程</span>
</span></span><span style=display:flex><span>$ scp file.txt user@hostname:/remote/directory
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 将本机整个目录拷贝到远程目录下</span>
</span></span><span style=display:flex><span>$ scp -r local/directory user@hostname:/remote_directory/
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 将本机目录下的所有内容拷贝到远程目录下</span>
</span></span><span style=display:flex><span>$ scp -r local/directory/* user@hostname:/remote_directory/
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 远程文件复制到本地</span>
</span></span><span style=display:flex><span>$ scp user@hostname:/remote/file.txt /local/directory
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 拷贝远程目录下的所有内容，到本机目录下</span>
</span></span><span style=display:flex><span>$ scp -r user@hostname:directory/SourceFolder TargetFolder
</span></span></code></pre></div><h3 id=sftp>sftp
<a class=anchor href=#sftp>#</a></h3><p><code>sftp</code> 是 SSH 提供的一个客户端应用程序，主要用来安全地访问 FTP。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sftp user@hostname
</span></span></code></pre></div><p>验证成功以后，就会出现 FTP 的提示符 <code>sftp></code>：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sftp root@example.com
</span></span><span style=display:flex><span>root@example.com<span style=color:#960050;background-color:#1e0010>&#39;</span>s password:
</span></span><span style=display:flex><span>Connected to example.com.
</span></span><span style=display:flex><span>sftp&gt;
</span></span></code></pre></div><p>然后就可以输入 FTP 命令。</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/shipengqi/os-learn/commit/35b27e7c47e7c4d33047856c257b2a270bbde523 title='Last modified by PengQi Shi | September 12, 2024' target=_blank rel=noopener><img src=/os-learn/svg/calendar.svg class=book-icon alt=Calendar>
<span>September 12, 2024</span></a></div><div><a class="flex align-center" href=https://github.com/shipengqi/os-learn/edit/master/content/docs/commands/18_ssh.md target=_blank rel=noopener><img src=/os-learn/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#ssh>SSH</a><ul><li><a href=#ssh-客户端>SSH 客户端</a><ul><li><a href=#客户端连接流程>客户端连接流程</a></li><li><a href=#服务器密钥变更>服务器密钥变更</a></li><li><a href=#配置文件>配置文件</a></li></ul></li><li><a href=#密钥登录>密钥登录</a><ul><li><a href=#ssh-agent>ssh-agent</a></li></ul></li><li><a href=#ssh-服务器>SSH 服务器</a><ul><li><a href=#配置文件-1>配置文件</a></li></ul></li><li><a href=#scp-和-sftp>scp 和 sftp</a><ul><li><a href=#scp>scp</a></li><li><a href=#sftp>sftp</a></li></ul></li></ul></li></ul></nav></div></aside></main></body></html>