<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="进程管理 # 进程的生命周期是可管理的。
查看进程 # ps pstree top 进程也是树形结构。进程和权限密不可分。
ps # 执行 ps 查看当前终端的可以看到的进程，p 代表 processes，也就是进程；s 代表 snapshot，也就是快照：
[root@pooky ~]# ps PID TTY TIME CMD 8974 pts/2 00:00:00 bash 12550 pts/2 00:00:00 ps ps -e 查看所有终端的进程：
[root@pooky ~]# ps -e PID TTY TIME CMD 1 ? 00:50:59 systemd 2 ? 00:00:06 kthreadd 3 ? 00:00:01 ksoftirqd/0 5 ? 00:00:00 kworker/0:0H 7 ? 00:00:00 migration/0 8 ? 00:00:00 rcu_bh 9 ?"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:title" content="进程管理"><meta property="og:description" content="进程管理 # 进程的生命周期是可管理的。
查看进程 # ps pstree top 进程也是树形结构。进程和权限密不可分。
ps # 执行 ps 查看当前终端的可以看到的进程，p 代表 processes，也就是进程；s 代表 snapshot，也就是快照：
[root@pooky ~]# ps PID TTY TIME CMD 8974 pts/2 00:00:00 bash 12550 pts/2 00:00:00 ps ps -e 查看所有终端的进程：
[root@pooky ~]# ps -e PID TTY TIME CMD 1 ? 00:50:59 systemd 2 ? 00:00:06 kthreadd 3 ? 00:00:01 ksoftirqd/0 5 ? 00:00:00 kworker/0:0H 7 ? 00:00:00 migration/0 8 ? 00:00:00 rcu_bh 9 ?"><meta property="og:type" content="article"><meta property="og:url" content="http://shipengqi.github.io/os-learn/docs/commands/09_process/"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2023-11-15T17:26:03+08:00"><title>进程管理 | OS Learning</title><link rel=manifest href=/os-learn/manifest.json><link rel=icon href=/os-learn/favicon.png><link rel=stylesheet href=/os-learn/book.min.33a48f5432973b8ff9a82679d9e45d67f2c15d4399bd2829269455cfe390b5e8.css integrity="sha256-M6SPVDKXO4/5qCZ52eRdZ/LBXUOZvSgpJpRVz+OQteg=" crossorigin=anonymous><script defer src=/os-learn/flexsearch.min.js></script>
<script defer src=/os-learn/en.search.min.9da2651f3362f085ba92fedcac79d3065ce93b32c3817feded7d23b6337f4ee9.js integrity="sha256-naJlHzNi8IW6kv7crHnTBlzpOzLDgX/t7X0jtjN/Tuk=" crossorigin=anonymous></script>
<script defer src=/os-learn/sw.min.73e4e12d3b3ff9b5bd6410a479234d8908ebac0e4d11ef31f508715b8e7f7c7d.js integrity="sha256-c+ThLTs/+bW9ZBCkeSNNiQjrrA5NEe8x9QhxW45/fH0=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/os-learn/><span>OS Learning</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=https://shipengqi.github.io/ target=_blank rel=noopener>Blog</a></li><li><a href=https://github.com/shipengqi/os-learn target=_blank rel=noopener>Github</a></li></ul><ul><li><span>Linux 常用命令</span><ul><li><a href=/os-learn/docs/commands/01_view_text/>查看文件内容</a></li><li><a href=/os-learn/docs/commands/02_tar/>打包压缩</a></li><li><a href=/os-learn/docs/commands/03_vim/>Vim</a></li><li><a href=/os-learn/docs/commands/04_user_manage/>用户管理</a></li><li><a href=/os-learn/docs/commands/05_file_perm/>文件权限</a></li><li><a href=/os-learn/docs/commands/06_network/>网络管理</a></li><li><a href=/os-learn/docs/commands/07_package_manage/>包管理器</a></li><li><a href=/os-learn/docs/commands/08_grup/>grup</a></li><li><a href=/os-learn/docs/commands/09_process/ class=active>进程管理</a></li><li><a href=/os-learn/docs/commands/10_systemd/>systemctl</a></li><li><a href=/os-learn/docs/commands/11_selinux/>SELinux</a></li><li><a href=/os-learn/docs/commands/12_mem_disk/>内存和磁盘</a></li><li><a href=/os-learn/docs/commands/13_sar/>查看系统状态</a></li><li><a href=/os-learn/docs/commands/14_shell/>Shell</a></li><li><a href=/os-learn/docs/commands/15_script_priority/>脚本控制</a></li><li><a href=/os-learn/docs/commands/16_text_operation/>操作文本</a></li><li><a href=/os-learn/docs/commands/17_firewall/>防火墙</a></li><li><a href=/os-learn/docs/commands/18_ssh/>SSH</a></li><li><a href=/os-learn/docs/commands/19_ftp/>FTP</a></li><li><a href=/os-learn/docs/commands/20_nfs/>NFS</a></li><li><a href=/os-learn/docs/commands/21_dns/>DNS</a></li><li><a href=/os-learn/docs/commands/22_kernel_upgrade/>内核升级</a></li><li><a href=/os-learn/docs/commands/23_pty_tty/>pty</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/os-learn/svg/menu.svg class=book-icon alt=Menu></label>
<strong>进程管理</strong>
<label for=toc-control><img src=/os-learn/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#进程管理>进程管理</a><ul><li><a href=#查看进程>查看进程</a><ul><li><a href=#ps>ps</a></li><li><a href=#pstree>pstree</a></li><li><a href=#top>top</a></li></ul></li><li><a href=#进程控制>进程控制</a><ul><li><a href=#nice>nice</a></li><li><a href=#jobs>jobs</a></li></ul></li><li><a href=#kill>kill</a></li><li><a href=#守护进程>守护进程</a><ul><li><a href=#nohup>nohup</a></li><li><a href=#daemon>daemon</a></li><li><a href=#screen>screen</a></li><li><a href=#系统日志>系统日志</a></li></ul></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=进程管理>进程管理
<a class=anchor href=#%e8%bf%9b%e7%a8%8b%e7%ae%a1%e7%90%86>#</a></h1><p>进程的生命周期是可管理的。</p><h2 id=查看进程>查看进程
<a class=anchor href=#%e6%9f%a5%e7%9c%8b%e8%bf%9b%e7%a8%8b>#</a></h2><ul><li><code>ps</code></li><li><code>pstree</code></li><li><code>top</code></li></ul><p>进程也是树形结构。进程和权限密不可分。</p><h3 id=ps>ps
<a class=anchor href=#ps>#</a></h3><p>执行 <code>ps</code> 查看当前终端的可以看到的进程，p 代表 processes，也就是进程；s 代表 snapshot，也就是快照：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># ps</span>
</span></span><span style=display:flex><span>  PID TTY          TIME CMD
</span></span><span style=display:flex><span> <span style=color:#ae81ff>8974</span> pts/2    00:00:00 bash
</span></span><span style=display:flex><span><span style=color:#ae81ff>12550</span> pts/2    00:00:00 ps
</span></span></code></pre></div><p><code>ps -e</code> 查看所有终端的进程：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># ps -e</span>
</span></span><span style=display:flex><span>  PID TTY          TIME CMD
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>1</span> ?        00:50:59 systemd
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>2</span> ?        00:00:06 kthreadd
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>3</span> ?        00:00:01 ksoftirqd/0
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>5</span> ?        00:00:00 kworker/0:0H
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>7</span> ?        00:00:00 migration/0
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>8</span> ?        00:00:00 rcu_bh
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>9</span> ?        00:26:58 rcu_sched
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>10</span> ?        00:00:00 lru-add-drain
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>11</span> ?        00:00:23 watchdog/0
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>12</span> ?        00:00:23 watchdog/1
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>13</span> ?        00:00:04 migration/1
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>14</span> ?        00:00:02 ksoftirqd/1
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>16</span> ?        00:00:00 kworker/1:0H
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>17</span> ?        00:00:25 watchdog/2
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>18</span> ?        00:00:00 migration/2
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>19</span> ?        00:00:01 ksoftirqd/2
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>21</span> ?        00:00:00 kworker/2:0H
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>22</span> ?        00:00:25 watchdog/3
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>23</span> ?        00:00:04 migration/3
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>24</span> ?        00:00:02 ksoftirqd/3
</span></span></code></pre></div><ul><li><code>ps -A</code> 和 <code>ps -e</code> 一样</li><li><code>ps -ef</code> 显示所有进程，包含命令信息，<code>-f</code> 包含更多描述字段</li><li><code>ps -eLf</code> 显示线程</li><li><code>ps -au</code> 显示详细的信息</li><li><code>ps -aux</code> 显示所有用户的进程</li><li><code>ps -u root</code> 显示 root 用户的进程</li></ul><h3 id=pstree>pstree
<a class=anchor href=#pstree>#</a></h3><p>查看进程之间的关系。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e>#   pstree</span>
</span></span><span style=display:flex><span>systemd─┬─ModemManager───2*<span style=color:#f92672>[{</span>ModemManager<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        ├─NetworkManager─┬─dhclient
</span></span><span style=display:flex><span>        │                └─2*<span style=color:#f92672>[{</span>NetworkManager<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        ├─VGAuthService
</span></span><span style=display:flex><span>        ├─2*<span style=color:#f92672>[</span>abrt-watch-log<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>        ├─abrtd
</span></span><span style=display:flex><span>        ├─accounts-daemon───2*<span style=color:#f92672>[{</span>accounts-daemon<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        ├─alsactl
</span></span><span style=display:flex><span>        ├─at-spi-bus-laun─┬─dbus-daemon───<span style=color:#f92672>{</span>dbus-daemon<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        │                 └─3*<span style=color:#f92672>[{</span>at-spi-bus-laun<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        ├─at-spi2-registr───2*<span style=color:#f92672>[{</span>at-spi2-registr<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        ├─atd
</span></span><span style=display:flex><span>        ├─auditd─┬─audispd─┬─sedispatch
</span></span><span style=display:flex><span>        │        │         └─<span style=color:#f92672>{</span>audispd<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        │        └─<span style=color:#f92672>{</span>auditd<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        ├─avahi-daemon───avahi-daemon
</span></span><span style=display:flex><span>        ├─chronyd
</span></span><span style=display:flex><span>        ├─colord───2*<span style=color:#f92672>[{</span>colord<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        ├─crond
</span></span><span style=display:flex><span>        ├─cupsd
</span></span><span style=display:flex><span>        ├─2*<span style=color:#f92672>[</span>dbus-daemon───<span style=color:#f92672>{</span>dbus-daemon<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        ├─dbus-launch
</span></span><span style=display:flex><span>        ├─dnsmasq───dnsmasq
</span></span><span style=display:flex><span>        ├─dockerd─┬─containerd───27*<span style=color:#f92672>[{</span>containerd<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        │         └─45*<span style=color:#f92672>[{</span>dockerd<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        ├─gdm─┬─X───9*<span style=color:#f92672>[{</span>X<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        │     ├─gdm-session-wor─┬─gnome-session-b─┬─gnome-shell─┬─ibus-daemon─┬─ibus-dconf───3*<span style=color:#f92672>[{</span>ibus-dconf<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        │     │                 │                 │             │             ├─ibus-engine-sim───2*<span style=color:#f92672>[{</span>ibus-engine-sim+
</span></span><span style=display:flex><span>        │     │                 │                 │             │             └─2*<span style=color:#f92672>[{</span>ibus-daemon<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        │     │                 │                 │             └─32*<span style=color:#f92672>[{</span>gnome-shell<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        │     │                 │                 ├─gsd-a11y-keyboa───3*<span style=color:#f92672>[{</span>gsd-a11y-keyboa<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        │     │                 │                 ├─gsd-a11y-settin───3*<span style=color:#f92672>[{</span>gsd-a11y-settin<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        │     │                 │                 ├─gsd-clipboard───2*<span style=color:#f92672>[{</span>gsd-clipboard<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        │     │                 │                 ├─gsd-color───3*<span style=color:#f92672>[{</span>gsd-color<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        │     │                 │                 ├─gsd-datetime───2*<span style=color:#f92672>[{</span>gsd-datetime<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        │     │                 │                 ├─gsd-housekeepin───2*<span style=color:#f92672>[{</span>gsd-housekeepin<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        │     │                 │                 ├─gsd-keyboard───3*<span style=color:#f92672>[{</span>gsd-keyboard<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        │     │                 │                 ├─gsd-media-keys───3*<span style=color:#f92672>[{</span>gsd-media-keys<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        │     │                 │                 ├─gsd-mouse───2*<span style=color:#f92672>[{</span>gsd-mouse<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        │     │                 │                 ├─gsd-power───3*<span style=color:#f92672>[{</span>gsd-power<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        │     │                 │                 ├─gsd-print-notif───2*<span style=color:#f92672>[{</span>gsd-print-notif<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        │     │                 │                 ├─gsd-rfkill───2*<span style=color:#f92672>[{</span>gsd-rfkill<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        │     │                 │                 ├─gsd-screensaver───2*<span style=color:#f92672>[{</span>gsd-screensaver<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        │     │                 │                 ├─gsd-sharing───3*<span style=color:#f92672>[{</span>gsd-sharing<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        │     │                 │                 ├─gsd-smartcard───4*<span style=color:#f92672>[{</span>gsd-smartcard<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        │     │                 │                 ├─gsd-sound───3*<span style=color:#f92672>[{</span>gsd-sound<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        │     │                 │                 ├─gsd-wacom───2*<span style=color:#f92672>[{</span>gsd-wacom<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        │     │                 │                 ├─gsd-xsettings───3*<span style=color:#f92672>[{</span>gsd-xsettings<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        │     │                 │                 └─3*<span style=color:#f92672>[{</span>gnome-session-b<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        │     │                 └─2*<span style=color:#f92672>[{</span>gdm-session-wor<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        │     └─3*<span style=color:#f92672>[{</span>gdm<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        ├─gssproxy───5*<span style=color:#f92672>[{</span>gssproxy<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        ├─ibus-portal───2*<span style=color:#f92672>[{</span>ibus-portal<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        ├─ibus-x11───2*<span style=color:#f92672>[{</span>ibus-x11<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        ├─irqbalance
</span></span><span style=display:flex><span>        ├─ksmtuned───sleep
</span></span><span style=display:flex><span>        ├─libvirtd───16*<span style=color:#f92672>[{</span>libvirtd<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        ├─lsmd
</span></span><span style=display:flex><span>        ├─lvmetad
</span></span><span style=display:flex><span>        ├─master─┬─pickup
</span></span><span style=display:flex><span>        │        └─qmgr
</span></span><span style=display:flex><span>        ├─mcelog
</span></span><span style=display:flex><span>        ├─packagekitd───2*<span style=color:#f92672>[{</span>packagekitd<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        ├─polkitd───5*<span style=color:#f92672>[{</span>polkitd<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        ├─pulseaudio───<span style=color:#f92672>{</span>pulseaudio<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        ├─rhnsd
</span></span><span style=display:flex><span>        ├─rhsmcertd
</span></span><span style=display:flex><span>        ├─rpc.idmapd
</span></span><span style=display:flex><span>        ├─rpc.mountd
</span></span><span style=display:flex><span>        ├─rpc.statd
</span></span><span style=display:flex><span>        ├─rpcbind
</span></span><span style=display:flex><span>        ├─rsyslogd───2*<span style=color:#f92672>[{</span>rsyslogd<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        ├─rtkit-daemon───2*<span style=color:#f92672>[{</span>rtkit-daemon<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        ├─smartd
</span></span><span style=display:flex><span>        ├─sshd─┬─2*<span style=color:#f92672>[</span>sshd───bash<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>        │      ├─sshd───3*<span style=color:#f92672>[</span>sftp-server<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>        │      └─sshd───bash───pstree
</span></span><span style=display:flex><span>        ├─systemd-journal
</span></span><span style=display:flex><span>        ├─systemd-logind
</span></span><span style=display:flex><span>        ├─systemd-udevd
</span></span><span style=display:flex><span>        ├─udisksd───4*<span style=color:#f92672>[{</span>udisksd<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        ├─upowerd───2*<span style=color:#f92672>[{</span>upowerd<span style=color:#f92672>}]</span>
</span></span><span style=display:flex><span>        ├─vmtoolsd───<span style=color:#f92672>{</span>vmtoolsd<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        ├─wpa_supplicant
</span></span><span style=display:flex><span>        └─xdg-permission-───2*<span style=color:#f92672>[{</span>xdg-permission-<span style=color:#f92672>}]</span>
</span></span></code></pre></div><h3 id=top>top
<a class=anchor href=#top>#</a></h3><p><code>top</code> 显示进程和系统信息。其实和 <code>ps</code> 差不多，只不过显示的是实时数据。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># top</span>
</span></span><span style=display:flex><span>top - 21:01:33 up <span style=color:#ae81ff>62</span> days, 10:40,  <span style=color:#ae81ff>3</span> users,  load average: 0.05, 0.03, 0.05
</span></span><span style=display:flex><span>Tasks: <span style=color:#ae81ff>240</span> total,   <span style=color:#ae81ff>1</span> running, <span style=color:#ae81ff>239</span> sleeping,   <span style=color:#ae81ff>0</span> stopped,   <span style=color:#ae81ff>0</span> zombie
</span></span><span style=display:flex><span>%Cpu<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span>:  0.1 us,  0.1 sy,  0.0 ni, 99.8 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
</span></span><span style=display:flex><span>KiB Mem : <span style=color:#ae81ff>16266780</span> total,  <span style=color:#ae81ff>7581412</span> free,  <span style=color:#ae81ff>1100140</span> used,  <span style=color:#ae81ff>7585228</span> buff/cache
</span></span><span style=display:flex><span>KiB Swap:        <span style=color:#ae81ff>0</span> total,        <span style=color:#ae81ff>0</span> free,        <span style=color:#ae81ff>0</span> used. <span style=color:#ae81ff>14404532</span> avail Mem
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>936</span> root      <span style=color:#ae81ff>20</span>   <span style=color:#ae81ff>0</span> <span style=color:#ae81ff>1210844</span>  <span style=color:#ae81ff>37064</span>  <span style=color:#ae81ff>14992</span> S   0.7  0.2 583:14.27 containerd
</span></span><span style=display:flex><span><span style=color:#ae81ff>16865</span> root      <span style=color:#ae81ff>20</span>   <span style=color:#ae81ff>0</span>  <span style=color:#ae81ff>162096</span>   <span style=color:#ae81ff>2376</span>   <span style=color:#ae81ff>1576</span> R   0.7  0.0   0:00.13 top
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>786</span> avahi     <span style=color:#ae81ff>20</span>   <span style=color:#ae81ff>0</span>   <span style=color:#ae81ff>62372</span>   <span style=color:#ae81ff>2276</span>   <span style=color:#ae81ff>1812</span> S   0.3  0.0 341:04.74 avahi-daemon
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>805</span> root      <span style=color:#ae81ff>20</span>   <span style=color:#ae81ff>0</span> <span style=color:#ae81ff>2208132</span>  <span style=color:#ae81ff>91280</span>  <span style=color:#ae81ff>26176</span> S   0.3  0.6 349:03.69 dockerd
</span></span><span style=display:flex><span> <span style=color:#ae81ff>2067</span> gdm       <span style=color:#ae81ff>20</span>   <span style=color:#ae81ff>0</span>  <span style=color:#ae81ff>755416</span>  <span style=color:#ae81ff>32672</span>   <span style=color:#ae81ff>9388</span> S   0.3  0.2 271:23.92 gsd-color
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>1</span> root      <span style=color:#ae81ff>20</span>   <span style=color:#ae81ff>0</span>  <span style=color:#ae81ff>194124</span>   <span style=color:#ae81ff>7264</span>   <span style=color:#ae81ff>4188</span> S   0.0  0.0  51:00.39 systemd
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>2</span> root      <span style=color:#ae81ff>20</span>   <span style=color:#ae81ff>0</span>       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> S   0.0  0.0   0:06.19 kthreadd
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>3</span> root      <span style=color:#ae81ff>20</span>   <span style=color:#ae81ff>0</span>       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> S   0.0  0.0   0:01.14 ksoftirqd/0
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>5</span> root       <span style=color:#ae81ff>0</span> -20       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> S   0.0  0.0   0:00.00 kworker/0:0H
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>7</span> root      rt   <span style=color:#ae81ff>0</span>       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> S   0.0  0.0   0:00.88 migration/0
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>8</span> root      <span style=color:#ae81ff>20</span>   <span style=color:#ae81ff>0</span>       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> S   0.0  0.0   0:00.00 rcu_bh
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>9</span> root      <span style=color:#ae81ff>20</span>   <span style=color:#ae81ff>0</span>       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> S   0.0  0.0  26:59.02 rcu_sched
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>10</span> root       <span style=color:#ae81ff>0</span> -20       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> S   0.0  0.0   0:00.00 lru-add-drain
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>11</span> root      rt   <span style=color:#ae81ff>0</span>       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> S   0.0  0.0   0:23.27 watchdog/0
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>12</span> root      rt   <span style=color:#ae81ff>0</span>       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> S   0.0  0.0   0:23.57 watchdog/1
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>13</span> root      rt   <span style=color:#ae81ff>0</span>       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> S   0.0  0.0   0:04.91 migration/1
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>14</span> root      <span style=color:#ae81ff>20</span>   <span style=color:#ae81ff>0</span>       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> S   0.0  0.0   0:02.78 ksoftirqd/1
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>16</span> root       <span style=color:#ae81ff>0</span> -20       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> S   0.0  0.0   0:00.00 kworker/1:0H
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>17</span> root      rt   <span style=color:#ae81ff>0</span>       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> S   0.0  0.0   0:25.69 watchdog/2
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>18</span> root      rt   <span style=color:#ae81ff>0</span>       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> S   0.0  0.0   0:00.70 migration/2
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>19</span> root      <span style=color:#ae81ff>20</span>   <span style=color:#ae81ff>0</span>       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> S   0.0  0.0   0:01.22 ksoftirqd/2
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>21</span> root       <span style=color:#ae81ff>0</span> -20       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> S   0.0  0.0   0:00.00 kworker/2:0H
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>22</span> root      rt   <span style=color:#ae81ff>0</span>       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> S   0.0  0.0   0:25.11 watchdog/3
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>23</span> root      rt   <span style=color:#ae81ff>0</span>       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> S   0.0  0.0   0:04.72 migration/3
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>24</span> root      <span style=color:#ae81ff>20</span>   <span style=color:#ae81ff>0</span>       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> S   0.0  0.0   0:02.66 ksoftirqd/3
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>26</span> root       <span style=color:#ae81ff>0</span> -20       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> S   0.0  0.0   0:00.00 kworker/3:0H
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>27</span> root      rt   <span style=color:#ae81ff>0</span>       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> S   0.0  0.0   0:29.23 watchdog/4
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>28</span> root      rt   <span style=color:#ae81ff>0</span>       <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>0</span> S   0.0  0.0   0:02.59 migration/4
</span></span></code></pre></div><p>第一行：</p><ul><li><code>21:01:33 up 62 days</code> 表示从系统开机到现在的运行时间。</li><li><code>3 users</code> 表示当前有 3 个用户登录</li><li><code>load average: 0.05, 0.03, 0.05</code> 系统平均负载，三个值分别表示 1 分钟，5 分钟，15 分钟内的平均负载。</li></ul><p>第二行：</p><ul><li><code>240 total</code> 表示有 240 个进程在运行</li><li><code>1 running, 239 sleeping, 0 stopped, 0 zombie</code> 运行的进程有不同的状态。这里就表示有 1 个 running 状态的进程，239 个 sleeping 状态的进程。</li></ul><p>第三行 CPU 使用情况：</p><ul><li><code>0.1 us, 0.1 sy, 0.0 ni, 99.8 id 0.0 wa</code>，其中 <code>0.1 us</code> 表示用户控件占用百分之 <code>0.1</code> 的 CPU，<code>0.1 sy</code> 表示内核空间占用百分之 <code>0.7</code> 的 CPU，<code>0.0 ni</code> 表示改变过优先级的进程 CPU 占比，<code>99.8 id</code> 表示空闲 CPU 占比，<code>wa</code> 表示 IO 等待，<code>0.0 hi</code> 硬件中断（hardware IRQ） CPU 占比，<code>0.0 si</code> 软件中断 CPU 占比。</li><li><code>%Cpu(s)</code> 显示的是多个 CPU 的平均值，如果想查看每个 CPU 对应的使用率，按<strong>数字键 <code>1</code>，就会展开所有的 CPU</strong>。</li></ul><p>第四行，内存的使用率：</p><ul><li><code>16266780 total, 7581412 free, 1100140 used, 7585228 buff/cache</code> 表示内存总量为 <code>16266780</code>，剩余可用内存为 <code>7581412</code>，已使用内存 <code>1100140</code>， <code>7585228 buff/cache</code> 表示正在用来读写的缓存。</li></ul><p>第五行，交换分区，当物理内存不够时，就需要使用 swap：</p><ul><li><code>0 total, 0 free, 0 used. 14404532 avail Mem</code>，<code>0 used</code> 表示没有使用 swap，说明物理内存还够用。</li></ul><p>再下面的信息是动态的进程信息：</p><ul><li><code>PR</code> 进程优先级</li><li><code>NI</code> nice 值。值越小优先级越高，最小 <code>-20</code> ，最大 20（用户设置最大 19）</li><li><code>VIRT</code> 进程虚拟内存的大小，只要是进程申请过的内存，即便还没有真正分配物理内存，也会计算在内。</li><li><code>RES</code> 是常驻内存的大小，也就是进程实际使用的物理内存大小，不包括 Swap 和共享内存。</li><li><code>SHR</code> 是共享内存的大小，比如与其他进程共同使用的共享内存、加载的动态链接库以及程序的代码段等。</li><li><code>S</code> 进程状态</li><li><code>%CPU</code> 进程占用 CPU 百分比</li><li><code>%MEM</code> 进程占用物理内存百分比。</li><li><code>TIME+</code> 进程运行时间</li></ul><p>常用参数：</p><ul><li><code>-d</code> 指定信息刷新的时间间隔。也可以使用按键 <code>s</code> 交互命令来改变。</li><li><code>-p</code> 指定进程 ID ，值显示指定进程的状态。</li><li><code>-i</code> 不显示闲置或者僵死进程。</li><li><code>-c</code> 显示完整的命令。</li></ul><h2 id=进程控制>进程控制
<a class=anchor href=#%e8%bf%9b%e7%a8%8b%e6%8e%a7%e5%88%b6>#</a></h2><ul><li>调整进程的优先级<ul><li>nice 范围从 <code>-20</code> 到 <code>19</code>，值越小表示优先级越高，抢占资源就越多</li><li>renice 重新设置优先级</li></ul></li><li>进程的作业控制<ul><li><code>&</code> 符号，后台运行进程，<code>./a.sh &</code>。</li><li>jobs</li></ul></li></ul><h3 id=nice>nice
<a class=anchor href=#nice>#</a></h3><p><code>a.sh</code> 是一个死循环的脚本：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>echo $$
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>while</span> :
</span></span><span style=display:flex><span><span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>  :
</span></span><span style=display:flex><span><span style=color:#66d9ef>done</span>
</span></span></code></pre></div><p>然后修改运行权限并运行：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># ./a.sh</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>23248</span>
</span></span></code></pre></div><p>打开一个新的终端，top 基本视图中，按数字 <code>1</code>，可监控每个逻辑 CPU 的状况：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># top -p 23294</span>
</span></span><span style=display:flex><span>top - 07:53:53 up <span style=color:#ae81ff>62</span> days, 21:33,  <span style=color:#ae81ff>4</span> users,  load average: 0.47, 0.15, 0.09
</span></span><span style=display:flex><span>Tasks:   <span style=color:#ae81ff>1</span> total,   <span style=color:#ae81ff>1</span> running,   <span style=color:#ae81ff>0</span> sleeping,   <span style=color:#ae81ff>0</span> stopped,   <span style=color:#ae81ff>0</span> zombie
</span></span><span style=display:flex><span>%Cpu0  :  0.0 us,  0.0 sy,  0.0 ni,100.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
</span></span><span style=display:flex><span>%Cpu1  :  0.0 us,  0.0 sy,  0.0 ni,100.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
</span></span><span style=display:flex><span>%Cpu2  :  0.0 us,  0.0 sy,  0.0 ni,100.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
</span></span><span style=display:flex><span>%Cpu3  :100.0 us,  0.0 sy,  0.0 ni,  0.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
</span></span><span style=display:flex><span>%Cpu4  :  0.0 us,  0.0 sy,  0.0 ni,100.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
</span></span><span style=display:flex><span>%Cpu5  :  0.0 us,  0.0 sy,  0.0 ni,100.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
</span></span><span style=display:flex><span>%Cpu6  :  0.0 us,  0.0 sy,  0.0 ni,100.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
</span></span><span style=display:flex><span>%Cpu7  :  0.0 us,  0.0 sy,  0.0 ni,100.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
</span></span><span style=display:flex><span>KiB Mem : <span style=color:#ae81ff>16266780</span> total,  <span style=color:#ae81ff>7566888</span> free,  <span style=color:#ae81ff>1105816</span> used,  <span style=color:#ae81ff>7594076</span> buff/cache
</span></span><span style=display:flex><span>KiB Swap:        <span style=color:#ae81ff>0</span> total,        <span style=color:#ae81ff>0</span> free,        <span style=color:#ae81ff>0</span> used. <span style=color:#ae81ff>14390072</span> avail Mem
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND
</span></span><span style=display:flex><span><span style=color:#ae81ff>23294</span> root      <span style=color:#ae81ff>20</span>   <span style=color:#ae81ff>0</span>  <span style=color:#ae81ff>113176</span>   <span style=color:#ae81ff>1192</span>   <span style=color:#ae81ff>1008</span> R 100.0  0.0   0:23.15 a.sh
</span></span></code></pre></div><p>可以看到进程已经占满了一个 CPU。进程的状态栏中 <code>PR</code> 就是进程的优先级， <code>NI</code> 就是 nice 值。</p><p>重新设置优先级，先把进程退出，然后使用 nice 命令设置：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># nice -n 10 ./a.sh</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>23780</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 打开新的终端</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># top -p 23780</span>
</span></span><span style=display:flex><span>top - 07:58:04 up <span style=color:#ae81ff>62</span> days, 21:37,  <span style=color:#ae81ff>4</span> users,  load average: 0.45, 0.47, 0.25
</span></span><span style=display:flex><span>Tasks:   <span style=color:#ae81ff>1</span> total,   <span style=color:#ae81ff>1</span> running,   <span style=color:#ae81ff>0</span> sleeping,   <span style=color:#ae81ff>0</span> stopped,   <span style=color:#ae81ff>0</span> zombie
</span></span><span style=display:flex><span>%Cpu<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span>:  0.2 us,  0.1 sy, 12.5 ni, 87.2 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
</span></span><span style=display:flex><span>KiB Mem : <span style=color:#ae81ff>16266780</span> total,  <span style=color:#ae81ff>7567992</span> free,  <span style=color:#ae81ff>1104504</span> used,  <span style=color:#ae81ff>7594284</span> buff/cache
</span></span><span style=display:flex><span>KiB Swap:        <span style=color:#ae81ff>0</span> total,        <span style=color:#ae81ff>0</span> free,        <span style=color:#ae81ff>0</span> used. <span style=color:#ae81ff>14391492</span> avail Mem
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND
</span></span><span style=display:flex><span><span style=color:#ae81ff>23780</span> root      <span style=color:#ae81ff>30</span>  <span style=color:#ae81ff>10</span>  <span style=color:#ae81ff>113176</span>   <span style=color:#ae81ff>1188</span>   <span style=color:#ae81ff>1004</span> R  92.4  0.0   0:11.20 a.sh
</span></span></code></pre></div><p>如果要对已经运行的进程，不想停掉进程，来设置 nice 值，可以使用 renice：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># renice -n 15 23780</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>24155</span> <span style=color:#f92672>(</span>process ID<span style=color:#f92672>)</span> old priority 10, new priority <span style=color:#ae81ff>15</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 打开新的终端</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># top -p 23780</span>
</span></span></code></pre></div><h3 id=jobs>jobs
<a class=anchor href=#jobs>#</a></h3><p>加上 <code>&</code> 可以使进程后台运行，要把后台运行的进程掉回前台，使用 jobs 命令：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># ./a.sh &amp;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>1<span style=color:#f92672>]</span> <span style=color:#ae81ff>24397</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># jobs</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>1<span style=color:#f92672>]</span>+  Running                 ./a.sh &amp;
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># fg 1</span>
</span></span><span style=display:flex><span>./a.sh
</span></span></code></pre></div><p>运行 <code>fg &lt;job 号></code> 将进程调回前台。</p><h4 id=前台进程调到后台>前台进程调到后台
<a class=anchor href=#%e5%89%8d%e5%8f%b0%e8%bf%9b%e7%a8%8b%e8%b0%83%e5%88%b0%e5%90%8e%e5%8f%b0>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># ./a.sh</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>24682</span>
</span></span><span style=display:flex><span>^Z
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>1<span style=color:#f92672>]</span>+  Stopped                 ./a.sh
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># top -p 24682</span>
</span></span><span style=display:flex><span>top - 08:12:06 up <span style=color:#ae81ff>62</span> days, 21:51,  <span style=color:#ae81ff>5</span> users,  load average: 0.07, 0.50, 0.45
</span></span><span style=display:flex><span>Tasks:   <span style=color:#ae81ff>1</span> total,   <span style=color:#ae81ff>0</span> running,   <span style=color:#ae81ff>0</span> sleeping,   <span style=color:#ae81ff>1</span> stopped,   <span style=color:#ae81ff>0</span> zombie
</span></span><span style=display:flex><span>%Cpu<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span>:  0.8 us,  0.8 sy,  0.0 ni, 98.4 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
</span></span><span style=display:flex><span>KiB Mem : <span style=color:#ae81ff>16266780</span> total,  <span style=color:#ae81ff>7564728</span> free,  <span style=color:#ae81ff>1107784</span> used,  <span style=color:#ae81ff>7594268</span> buff/cache
</span></span><span style=display:flex><span>KiB Swap:        <span style=color:#ae81ff>0</span> total,        <span style=color:#ae81ff>0</span> free,        <span style=color:#ae81ff>0</span> used. <span style=color:#ae81ff>14388276</span> avail Mem
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND
</span></span><span style=display:flex><span><span style=color:#ae81ff>24682</span> root      <span style=color:#ae81ff>20</span>   <span style=color:#ae81ff>0</span>  <span style=color:#ae81ff>113176</span>   <span style=color:#ae81ff>1188</span>   <span style=color:#ae81ff>1008</span> T   0.0  0.0   0:01.81 a.sh
</span></span></code></pre></div><p><code>ctrl + z</code> 可以将前台进程调度到后台，但是状态是停止的。状态栏 <code>S</code> 的值是 <code>T</code> 就表示已停止。</p><p>要想恢复继续到前台就使用 <code>jobs</code> 加 <code>fg</code>。如果想要恢复到后台运行使用 <code>bd &lt;job 号></code>。</p><h2 id=kill>kill
<a class=anchor href=#kill>#</a></h2><p><code>kill -l</code> 可以查看所有信号：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># kill -l</span>
</span></span><span style=display:flex><span> 1<span style=color:#f92672>)</span> SIGHUP  2<span style=color:#f92672>)</span> SIGINT  3<span style=color:#f92672>)</span> SIGQUIT  4<span style=color:#f92672>)</span> SIGILL  5<span style=color:#f92672>)</span> SIGTRAP
</span></span><span style=display:flex><span> 6<span style=color:#f92672>)</span> SIGABRT  7<span style=color:#f92672>)</span> SIGBUS  8<span style=color:#f92672>)</span> SIGFPE  9<span style=color:#f92672>)</span> SIGKILL 10<span style=color:#f92672>)</span> SIGUSR1
</span></span><span style=display:flex><span>11<span style=color:#f92672>)</span> SIGSEGV 12<span style=color:#f92672>)</span> SIGUSR2 13<span style=color:#f92672>)</span> SIGPIPE 14<span style=color:#f92672>)</span> SIGALRM 15<span style=color:#f92672>)</span> SIGTERM
</span></span><span style=display:flex><span>16<span style=color:#f92672>)</span> SIGSTKFLT 17<span style=color:#f92672>)</span> SIGCHLD 18<span style=color:#f92672>)</span> SIGCONT 19<span style=color:#f92672>)</span> SIGSTOP 20<span style=color:#f92672>)</span> SIGTSTP
</span></span><span style=display:flex><span>21<span style=color:#f92672>)</span> SIGTTIN 22<span style=color:#f92672>)</span> SIGTTOU 23<span style=color:#f92672>)</span> SIGURG 24<span style=color:#f92672>)</span> SIGXCPU 25<span style=color:#f92672>)</span> SIGXFSZ
</span></span><span style=display:flex><span>26<span style=color:#f92672>)</span> SIGVTALRM 27<span style=color:#f92672>)</span> SIGPROF 28<span style=color:#f92672>)</span> SIGWINCH 29<span style=color:#f92672>)</span> SIGIO 30<span style=color:#f92672>)</span> SIGPWR
</span></span><span style=display:flex><span>31<span style=color:#f92672>)</span> SIGSYS 34<span style=color:#f92672>)</span> SIGRTMIN 35<span style=color:#f92672>)</span> SIGRTMIN+1 36<span style=color:#f92672>)</span> SIGRTMIN+2 37<span style=color:#f92672>)</span> SIGRTMIN+3
</span></span><span style=display:flex><span>38<span style=color:#f92672>)</span> SIGRTMIN+4 39<span style=color:#f92672>)</span> SIGRTMIN+5 40<span style=color:#f92672>)</span> SIGRTMIN+6 41<span style=color:#f92672>)</span> SIGRTMIN+7 42<span style=color:#f92672>)</span> SIGRTMIN+8
</span></span><span style=display:flex><span>43<span style=color:#f92672>)</span> SIGRTMIN+9 44<span style=color:#f92672>)</span> SIGRTMIN+10 45<span style=color:#f92672>)</span> SIGRTMIN+11 46<span style=color:#f92672>)</span> SIGRTMIN+12 47<span style=color:#f92672>)</span> SIGRTMIN+13
</span></span><span style=display:flex><span>48<span style=color:#f92672>)</span> SIGRTMIN+14 49<span style=color:#f92672>)</span> SIGRTMIN+15 50<span style=color:#f92672>)</span> SIGRTMAX-14 51<span style=color:#f92672>)</span> SIGRTMAX-13 52<span style=color:#f92672>)</span> SIGRTMAX-12
</span></span><span style=display:flex><span>53<span style=color:#f92672>)</span> SIGRTMAX-11 54<span style=color:#f92672>)</span> SIGRTMAX-10 55<span style=color:#f92672>)</span> SIGRTMAX-9 56<span style=color:#f92672>)</span> SIGRTMAX-8 57<span style=color:#f92672>)</span> SIGRTMAX-7
</span></span><span style=display:flex><span>58<span style=color:#f92672>)</span> SIGRTMAX-6 59<span style=color:#f92672>)</span> SIGRTMAX-5 60<span style=color:#f92672>)</span> SIGRTMAX-4 61<span style=color:#f92672>)</span> SIGRTMAX-3 62<span style=color:#f92672>)</span> SIGRTMAX-2
</span></span><span style=display:flex><span>63<span style=color:#f92672>)</span> SIGRTMAX-1 64<span style=color:#f92672>)</span> SIGRTMAX
</span></span></code></pre></div><p>一共有 64 个信号。常用的 <code>ctrl + c</code> 就是 <code>SIGINT</code> 信号。</p><p><code>kill -&lt;信号的编号> &lt;进程号></code> 比如 <code>kill -9 28317</code> 杀死 <code>28317</code> 进程，不受任何阻断。注意 1 号进程是杀不掉的。</p><h2 id=守护进程>守护进程
<a class=anchor href=#%e5%ae%88%e6%8a%a4%e8%bf%9b%e7%a8%8b>#</a></h2><ul><li>使用 nohup （no hang up）和 <code>&</code> （表示后台运行） 运行命令，nohup 命令会忽略 hangup 信号。</li><li>守护（daemon）进程，如 linux 的 service。</li></ul><h3 id=nohup>nohup
<a class=anchor href=#nohup>#</a></h3><p>当我们在终端运行一个进程时，如果终端关闭，那么进程也会被杀死，如果不想进程被杀死，可以使用 nohup 命令：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># nohup tail -f /var/log/messages &amp;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>1<span style=color:#f92672>]</span> <span style=color:#ae81ff>11725</span>
</span></span><span style=display:flex><span>nohup: ignoring input and appending output to ‘nohup.out’
</span></span></code></pre></div><p>nohup 即使关掉终端，进程依然运行。<code>&</code> 是后台运行。命令的输出会输出到 <code>nohup.out</code>。</p><p>执行 <code>ps -ef | grep tail</code> 查看进程：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># ps -ef | grep tail</span>
</span></span><span style=display:flex><span>root     <span style=color:#ae81ff>11725</span> <span style=color:#ae81ff>10056</span>  <span style=color:#ae81ff>0</span> 21:06 pts/1    00:00:00 tail -f /var/log/messages
</span></span><span style=display:flex><span>root     <span style=color:#ae81ff>11840</span> <span style=color:#ae81ff>10056</span>  <span style=color:#ae81ff>0</span> 21:08 pts/1    00:00:00 grep --color<span style=color:#f92672>=</span>auto tail
</span></span></code></pre></div><p>关闭终端，再次查看：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky 1320<span style=color:#f92672>]</span><span style=color:#75715e># ps -ef | grep tail</span>
</span></span><span style=display:flex><span>root     <span style=color:#ae81ff>11725</span>     <span style=color:#ae81ff>1</span>  <span style=color:#ae81ff>0</span> 21:06 ?        00:00:00 tail -f /var/log/messages
</span></span><span style=display:flex><span>root     <span style=color:#ae81ff>11911</span> <span style=color:#ae81ff>11454</span>  <span style=color:#ae81ff>0</span> 21:09 pts/2    00:00:00 grep --color<span style=color:#f92672>=</span>auto tail
</span></span></code></pre></div><p>11725 进程还在，但是父进程变成了 1。因为 11725 的父进程终端被关掉了，11725 就变成了孤儿进程，孤儿进程会被 1 号进程（systemd）收留。
daemon 进程其实也是类似的原理，自动结束了父进程，被 1 号进程收留。</p><p>进程的信息会输出到 <code>/proc/</code> 目录下：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky 1320<span style=color:#f92672>]</span><span style=color:#75715e># cd /proc/11725</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky 11725<span style=color:#f92672>]</span><span style=color:#75715e># ll cwd</span>
</span></span><span style=display:flex><span>lrwxrwxrwx. <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>0</span> Aug <span style=color:#ae81ff>24</span> 21:13 cwd -&gt; /root
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky 11725<span style=color:#f92672>]</span><span style=color:#75715e># ll fd</span>
</span></span><span style=display:flex><span>total <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>l-wx------. <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>64</span> Aug <span style=color:#ae81ff>24</span> 21:13 <span style=color:#ae81ff>0</span> -&gt; /dev/null
</span></span><span style=display:flex><span>l-wx------. <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>64</span> Aug <span style=color:#ae81ff>24</span> 21:13 <span style=color:#ae81ff>1</span> -&gt; /root/nohup.out
</span></span><span style=display:flex><span>l-wx------. <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>64</span> Aug <span style=color:#ae81ff>24</span> 21:08 <span style=color:#ae81ff>2</span> -&gt; /root/nohup.out
</span></span><span style=display:flex><span>lr-x------. <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>64</span> Aug <span style=color:#ae81ff>24</span> 21:13 <span style=color:#ae81ff>3</span> -&gt; /var/log/messages
</span></span><span style=display:flex><span>lr-x------. <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>64</span> Aug <span style=color:#ae81ff>24</span> 21:13 <span style=color:#ae81ff>4</span> -&gt; anon_inode:inotify
</span></span></code></pre></div><p><code>ll cwd</code> 可以看出 <code>tail</code> 命令实在 <code>/root</code> 下执行的，那么 <code>/root</code> 目录就不能被卸载，因为
<code>tail</code> 命令正在使用这个目录。</p><p><code>fd</code> 文件下，可以查看进程的输入输出。0，1，2 分别是标准输入，标准输出，标准错误输出。<code>0 -> /dev/null</code> 表示标准输入被关掉。</p><h3 id=daemon>daemon
<a class=anchor href=#daemon>#</a></h3><p>daemon 不需要终端，比如 service。这种进程因为没有终端输出，所以需要日志文件来记录。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># ps -ef | grep sshd</span>
</span></span><span style=display:flex><span>root      <span style=color:#ae81ff>1320</span>     <span style=color:#ae81ff>1</span>  <span style=color:#ae81ff>0</span> Jun22 ?        00:00:02 /usr/sbin/sshd -D
</span></span><span style=display:flex><span>root      <span style=color:#ae81ff>6333</span>  <span style=color:#ae81ff>1320</span>  <span style=color:#ae81ff>0</span> 10:33 ?        00:00:01 sshd: root@pts/0
</span></span><span style=display:flex><span>root     <span style=color:#ae81ff>10044</span>  <span style=color:#ae81ff>1320</span>  <span style=color:#ae81ff>0</span> 20:40 ?        00:00:00 sshd: root@pts/1
</span></span><span style=display:flex><span>root     <span style=color:#ae81ff>11442</span>  <span style=color:#ae81ff>1320</span>  <span style=color:#ae81ff>6</span> 21:02 ?        00:00:00 sshd: root@pts/2
</span></span><span style=display:flex><span>root     <span style=color:#ae81ff>11514</span> <span style=color:#ae81ff>11454</span>  <span style=color:#ae81ff>0</span> 21:03 pts/2    00:00:00 grep --color<span style=color:#f92672>=</span>auto sshd
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># cd /proc/1320</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky 1320<span style=color:#f92672>]</span><span style=color:#75715e># ll cwd</span>
</span></span><span style=display:flex><span>lrwxrwxrwx. <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>0</span> Aug <span style=color:#ae81ff>24</span> 21:03 cwd -&gt; /
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky 1320<span style=color:#f92672>]</span><span style=color:#75715e># ll fd</span>
</span></span><span style=display:flex><span>total <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>lr-x------. <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>64</span> Jun <span style=color:#ae81ff>22</span> 10:21 <span style=color:#ae81ff>0</span> -&gt; /dev/null
</span></span><span style=display:flex><span>lrwx------. <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>64</span> Jun <span style=color:#ae81ff>22</span> 10:21 <span style=color:#ae81ff>1</span> -&gt; socket:<span style=color:#f92672>[</span>21458<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>lrwx------. <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>64</span> Jun <span style=color:#ae81ff>22</span> 10:21 <span style=color:#ae81ff>2</span> -&gt; socket:<span style=color:#f92672>[</span>21458<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>lrwx------. <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>64</span> Jun <span style=color:#ae81ff>22</span> 10:21 <span style=color:#ae81ff>3</span> -&gt; socket:<span style=color:#f92672>[</span>27755<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>lrwx------. <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>64</span> Jun <span style=color:#ae81ff>22</span> 10:21 <span style=color:#ae81ff>4</span> -&gt; socket:<span style=color:#f92672>[</span>27757<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>标准输出指向了 socket。</p><h3 id=screen>screen
<a class=anchor href=#screen>#</a></h3><p>有些时候在终端跑一些运行时间很长的任务，终端可能因为一些原因断开。screen 的功能，会话恢复，多窗口，会话共享。</p><p>只要 screen 本身没有终止，在其内部运行的会话都可以恢复。这一点对于远程登录的用户特别有用，即使网络连接中断，用户也不会失去对已经打开的命令行会话的控制。
只要再次登录到主机上执行 <code>screen -r</code> 就可以恢复会话的运行。</p><ul><li>执行 <code>screen</code> 命令进入 screen 环境</li><li><code>ctrl+a</code> 再按 <code>d</code> 退出 screen 环境</li><li><code>screen -ls</code> 查看 screen 的 session</li><li><code>screen -r &lt;sessionId></code> 恢复指定 session</li></ul><h3 id=系统日志>系统日志
<a class=anchor href=#%e7%b3%bb%e7%bb%9f%e6%97%a5%e5%bf%97>#</a></h3><p>系统日志一般在 <code>/var/log</code> 目录下。一些重要的日志：</p><ul><li><code>messages</code> 是系统的常规日志。</li><li><code>dmesg</code> 系统内核的启动日志。</li><li><code>secure</code> 系统的安全日志。</li><li><code>cron</code> 系统的计划任务日志。</li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/shipengqi/os-learn/commit/4f49c8bc26ad1442af2b9f5753687f18dc226c1a title='Last modified by shipengqi | November 15, 2023' target=_blank rel=noopener><img src=/os-learn/svg/calendar.svg class=book-icon alt=Calendar>
<span>November 15, 2023</span></a></div><div><a class="flex align-center" href=https://github.com/shipengqi/os-learn/edit/master/content/docs/commands/09_process.md target=_blank rel=noopener><img src=/os-learn/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#进程管理>进程管理</a><ul><li><a href=#查看进程>查看进程</a><ul><li><a href=#ps>ps</a></li><li><a href=#pstree>pstree</a></li><li><a href=#top>top</a></li></ul></li><li><a href=#进程控制>进程控制</a><ul><li><a href=#nice>nice</a></li><li><a href=#jobs>jobs</a></li></ul></li><li><a href=#kill>kill</a></li><li><a href=#守护进程>守护进程</a><ul><li><a href=#nohup>nohup</a></li><li><a href=#daemon>daemon</a></li><li><a href=#screen>screen</a></li><li><a href=#系统日志>系统日志</a></li></ul></li></ul></li></ul></nav></div></aside></main></body></html>