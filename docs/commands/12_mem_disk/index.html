<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="内存和磁盘 # 查看内存和磁盘的使用率 # 查看内存的使用率 # free top [root@pooky ~]# free total used free shared buff/cache available Mem: 16266780 1091532 7315128 157456 7860120 14383564 Swap: 0 0 0 [root@pooky ~]# free -m total used free shared buff/cache available Mem: 15885 1065 7144 153 7675 14046 Swap: 0 0 0 [root@pooky ~]# free -g total used free shared buff/cache available Mem: 15 1 6 0 7 13 Swap: 0 0 0 -m 和 -g 分别是指以 MB 和 GB 为单位显示。buff/cache 是进程使用的缓存。available 是释放掉 cache 后的可用内存。"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:title" content="内存和磁盘"><meta property="og:description" content="内存和磁盘 # 查看内存和磁盘的使用率 # 查看内存的使用率 # free top [root@pooky ~]# free total used free shared buff/cache available Mem: 16266780 1091532 7315128 157456 7860120 14383564 Swap: 0 0 0 [root@pooky ~]# free -m total used free shared buff/cache available Mem: 15885 1065 7144 153 7675 14046 Swap: 0 0 0 [root@pooky ~]# free -g total used free shared buff/cache available Mem: 15 1 6 0 7 13 Swap: 0 0 0 -m 和 -g 分别是指以 MB 和 GB 为单位显示。buff/cache 是进程使用的缓存。available 是释放掉 cache 后的可用内存。"><meta property="og:type" content="article"><meta property="og:url" content="http://shipengqi.github.io/os-learn/docs/commands/12_mem_disk/"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2023-11-15T17:26:03+08:00"><title>内存和磁盘 | OS Learning</title><link rel=manifest href=/os-learn/manifest.json><link rel=icon href=/os-learn/favicon.png><link rel=stylesheet href=/os-learn/book.min.33a48f5432973b8ff9a82679d9e45d67f2c15d4399bd2829269455cfe390b5e8.css integrity="sha256-M6SPVDKXO4/5qCZ52eRdZ/LBXUOZvSgpJpRVz+OQteg=" crossorigin=anonymous><script defer src=/os-learn/flexsearch.min.js></script>
<script defer src=/os-learn/en.search.min.6604ae75b544b331606533d1df45c879b810d1579a8b53a95e4916d989bd2a93.js integrity="sha256-ZgSudbVEszFgZTPR30XIebgQ0Veai1OpXkkW2Ym9KpM=" crossorigin=anonymous></script>
<script defer src=/os-learn/sw.min.73e4e12d3b3ff9b5bd6410a479234d8908ebac0e4d11ef31f508715b8e7f7c7d.js integrity="sha256-c+ThLTs/+bW9ZBCkeSNNiQjrrA5NEe8x9QhxW45/fH0=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/os-learn/><span>OS Learning</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=https://shipengqi.github.io/ target=_blank rel=noopener>Blog</a></li><li><a href=https://github.com/shipengqi/os-learn target=_blank rel=noopener>Github</a></li></ul><ul><li><span>Linux 常用命令</span><ul><li><a href=/os-learn/docs/commands/01_view_text/>查看文件内容</a></li><li><a href=/os-learn/docs/commands/02_tar/>打包压缩</a></li><li><a href=/os-learn/docs/commands/03_vim/>Vim</a></li><li><a href=/os-learn/docs/commands/04_user_manage/>用户管理</a></li><li><a href=/os-learn/docs/commands/05_file_perm/>文件权限</a></li><li><a href=/os-learn/docs/commands/06_network/>网络管理</a></li><li><a href=/os-learn/docs/commands/07_package_manage/>包管理器</a></li><li><a href=/os-learn/docs/commands/08_grup/>grup</a></li><li><a href=/os-learn/docs/commands/09_process/>进程管理</a></li><li><a href=/os-learn/docs/commands/10_systemd/>systemctl</a></li><li><a href=/os-learn/docs/commands/11_selinux/>SELinux</a></li><li><a href=/os-learn/docs/commands/12_mem_disk/ class=active>内存和磁盘</a></li><li><a href=/os-learn/docs/commands/13_sar/>查看系统状态</a></li><li><a href=/os-learn/docs/commands/14_shell/>Shell</a></li><li><a href=/os-learn/docs/commands/15_script_priority/>脚本控制</a></li><li><a href=/os-learn/docs/commands/16_text_operation/>操作文本</a></li><li><a href=/os-learn/docs/commands/17_firewall/>防火墙</a></li><li><a href=/os-learn/docs/commands/18_ssh/>SSH</a></li><li><a href=/os-learn/docs/commands/19_ftp/>FTP</a></li><li><a href=/os-learn/docs/commands/20_nfs/>NFS</a></li><li><a href=/os-learn/docs/commands/21_dns/>DNS</a></li><li><a href=/os-learn/docs/commands/22_kernel_upgrade/>内核升级</a></li><li><a href=/os-learn/docs/commands/23_pty_tty/>pty</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/os-learn/svg/menu.svg class=book-icon alt=Menu></label>
<strong>内存和磁盘</strong>
<label for=toc-control><img src=/os-learn/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#内存和磁盘>内存和磁盘</a><ul><li><a href=#查看内存和磁盘的使用率>查看内存和磁盘的使用率</a><ul><li><a href=#查看内存的使用率>查看内存的使用率</a></li><li><a href=#查看磁盘的使用率>查看磁盘的使用率</a></li></ul></li><li><a href=#linux-常见的文件系统>Linux 常见的文件系统</a><ul><li><a href=#ext4>ext4</a></li></ul></li><li><a href=#文件操作>文件操作</a><ul><li><a href=#修改文件>修改文件</a></li></ul></li><li><a href=#ln>ln</a><ul><li><a href=#软连接>软连接</a></li><li><a href=#facl>facl</a></li></ul></li><li><a href=#分区和挂载>分区和挂载</a><ul><li><a href=#配置文件>配置文件</a></li></ul></li><li><a href=#用户磁盘配额>用户磁盘配额</a></li><li><a href=#交换分区>交换分区</a><ul><li><a href=#使用文件方式扩充-swap>使用文件方式扩充 swap</a></li><li><a href=#配置文件-fstab>配置文件 fstab</a></li></ul></li><li><a href=#raid>RAID</a></li><li><a href=#逻辑卷>逻辑卷</a></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=内存和磁盘>内存和磁盘
<a class=anchor href=#%e5%86%85%e5%ad%98%e5%92%8c%e7%a3%81%e7%9b%98>#</a></h1><h2 id=查看内存和磁盘的使用率>查看内存和磁盘的使用率
<a class=anchor href=#%e6%9f%a5%e7%9c%8b%e5%86%85%e5%ad%98%e5%92%8c%e7%a3%81%e7%9b%98%e7%9a%84%e4%bd%bf%e7%94%a8%e7%8e%87>#</a></h2><h3 id=查看内存的使用率>查看内存的使用率
<a class=anchor href=#%e6%9f%a5%e7%9c%8b%e5%86%85%e5%ad%98%e7%9a%84%e4%bd%bf%e7%94%a8%e7%8e%87>#</a></h3><ul><li><code>free</code></li><li><code>top</code></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># free</span>
</span></span><span style=display:flex><span>              total        used        free      shared  buff/cache   available
</span></span><span style=display:flex><span>Mem:       <span style=color:#ae81ff>16266780</span>     <span style=color:#ae81ff>1091532</span>     <span style=color:#ae81ff>7315128</span>      <span style=color:#ae81ff>157456</span>     <span style=color:#ae81ff>7860120</span>    <span style=color:#ae81ff>14383564</span>
</span></span><span style=display:flex><span>Swap:             <span style=color:#ae81ff>0</span>           <span style=color:#ae81ff>0</span>           <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># free -m</span>
</span></span><span style=display:flex><span>              total        used        free      shared  buff/cache   available
</span></span><span style=display:flex><span>Mem:          <span style=color:#ae81ff>15885</span>        <span style=color:#ae81ff>1065</span>        <span style=color:#ae81ff>7144</span>         <span style=color:#ae81ff>153</span>        <span style=color:#ae81ff>7675</span>       <span style=color:#ae81ff>14046</span>
</span></span><span style=display:flex><span>Swap:             <span style=color:#ae81ff>0</span>           <span style=color:#ae81ff>0</span>           <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># free -g</span>
</span></span><span style=display:flex><span>              total        used        free      shared  buff/cache   available
</span></span><span style=display:flex><span>Mem:             <span style=color:#ae81ff>15</span>           <span style=color:#ae81ff>1</span>           <span style=color:#ae81ff>6</span>           <span style=color:#ae81ff>0</span>           <span style=color:#ae81ff>7</span>          <span style=color:#ae81ff>13</span>
</span></span><span style=display:flex><span>Swap:             <span style=color:#ae81ff>0</span>           <span style=color:#ae81ff>0</span>           <span style=color:#ae81ff>0</span>
</span></span></code></pre></div><p><code>-m</code> 和 <code>-g</code> 分别是指以 <code>MB</code> 和 <code>GB</code> 为单位显示。<code>buff/cache</code> 是进程使用的缓存。<code>available</code> 是释放掉 cache 后的可用内存。</p><p><code>Swap</code> 是交换分区，在内存不够用时，系统会自动把一部分暂时不用的内存移动到 swap 中。swap 交换分区使用的是磁盘。进程应该尽量不实用 swap，因为硬盘的读取是非常慢的。</p><p><strong>交换分区</strong>在 windows 中叫做<strong>虚拟内存</strong>。</p><h3 id=查看磁盘的使用率>查看磁盘的使用率
<a class=anchor href=#%e6%9f%a5%e7%9c%8b%e7%a3%81%e7%9b%98%e7%9a%84%e4%bd%bf%e7%94%a8%e7%8e%87>#</a></h3><ul><li><code>fdisk</code> 查看磁盘，磁盘分区。（<code>parted -l</code> 和 <code>fdisk -l</code> 类似）</li><li><code>df</code></li><li><code>du</code></li></ul><h4 id=fdisk>fdisk
<a class=anchor href=#fdisk>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># fdisk -l # 查看磁盘</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Disk /dev/sda: 214.7 GB, <span style=color:#ae81ff>214748364800</span> bytes, <span style=color:#ae81ff>419430400</span> sectors
</span></span><span style=display:flex><span>Units <span style=color:#f92672>=</span> sectors of <span style=color:#ae81ff>1</span> * 512 <span style=color:#f92672>=</span> <span style=color:#ae81ff>512</span> bytes
</span></span><span style=display:flex><span>Sector size <span style=color:#f92672>(</span>logical/physical<span style=color:#f92672>)</span>: <span style=color:#ae81ff>512</span> bytes / <span style=color:#ae81ff>512</span> bytes
</span></span><span style=display:flex><span>I/O size <span style=color:#f92672>(</span>minimum/optimal<span style=color:#f92672>)</span>: <span style=color:#ae81ff>512</span> bytes / <span style=color:#ae81ff>512</span> bytes
</span></span><span style=display:flex><span>Disk label type: dos
</span></span><span style=display:flex><span>Disk identifier: 0x00078ef0
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   Device Boot      Start         End      Blocks   Id  System
</span></span><span style=display:flex><span>/dev/sda1   *        <span style=color:#ae81ff>2048</span>     <span style=color:#ae81ff>4147199</span>     <span style=color:#ae81ff>2072576</span>   <span style=color:#ae81ff>83</span>  Linux
</span></span><span style=display:flex><span>/dev/sda2         <span style=color:#ae81ff>4147200</span>   <span style=color:#ae81ff>125788159</span>    <span style=color:#ae81ff>60820480</span>   8e  Linux LVM
</span></span><span style=display:flex><span>/dev/sda3       <span style=color:#ae81ff>125788160</span>   <span style=color:#ae81ff>419430399</span>   <span style=color:#ae81ff>146821120</span>   <span style=color:#ae81ff>83</span>  Linux
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Disk /dev/mapper/rhel-root: 205.1 GB, <span style=color:#ae81ff>205084688384</span> bytes, <span style=color:#ae81ff>400556032</span> sectors
</span></span><span style=display:flex><span>Units <span style=color:#f92672>=</span> sectors of <span style=color:#ae81ff>1</span> * 512 <span style=color:#f92672>=</span> <span style=color:#ae81ff>512</span> bytes
</span></span><span style=display:flex><span>Sector size <span style=color:#f92672>(</span>logical/physical<span style=color:#f92672>)</span>: <span style=color:#ae81ff>512</span> bytes / <span style=color:#ae81ff>512</span> bytes
</span></span><span style=display:flex><span>I/O size <span style=color:#f92672>(</span>minimum/optimal<span style=color:#f92672>)</span>: <span style=color:#ae81ff>512</span> bytes / <span style=color:#ae81ff>512</span> bytes
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Disk /dev/mapper/rhel-swap: <span style=color:#ae81ff>6442</span> MB, <span style=color:#ae81ff>6442450944</span> bytes, <span style=color:#ae81ff>12582912</span> sectors
</span></span><span style=display:flex><span>Units <span style=color:#f92672>=</span> sectors of <span style=color:#ae81ff>1</span> * 512 <span style=color:#f92672>=</span> <span style=color:#ae81ff>512</span> bytes
</span></span><span style=display:flex><span>Sector size <span style=color:#f92672>(</span>logical/physical<span style=color:#f92672>)</span>: <span style=color:#ae81ff>512</span> bytes / <span style=color:#ae81ff>512</span> bytes
</span></span><span style=display:flex><span>I/O size <span style=color:#f92672>(</span>minimum/optimal<span style=color:#f92672>)</span>: <span style=color:#ae81ff>512</span> bytes / <span style=color:#ae81ff>512</span> bytes
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Disk /dev/loop0: 107.4 GB, <span style=color:#ae81ff>107374182400</span> bytes, <span style=color:#ae81ff>209715200</span> sectors
</span></span><span style=display:flex><span>Units <span style=color:#f92672>=</span> sectors of <span style=color:#ae81ff>1</span> * 512 <span style=color:#f92672>=</span> <span style=color:#ae81ff>512</span> bytes
</span></span><span style=display:flex><span>Sector size <span style=color:#f92672>(</span>logical/physical<span style=color:#f92672>)</span>: <span style=color:#ae81ff>512</span> bytes / <span style=color:#ae81ff>512</span> bytes
</span></span><span style=display:flex><span>I/O size <span style=color:#f92672>(</span>minimum/optimal<span style=color:#f92672>)</span>: <span style=color:#ae81ff>512</span> bytes / <span style=color:#ae81ff>512</span> bytes
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Disk /dev/loop1: <span style=color:#ae81ff>2147</span> MB, <span style=color:#ae81ff>2147483648</span> bytes, <span style=color:#ae81ff>4194304</span> sectors
</span></span><span style=display:flex><span>Units <span style=color:#f92672>=</span> sectors of <span style=color:#ae81ff>1</span> * 512 <span style=color:#f92672>=</span> <span style=color:#ae81ff>512</span> bytes
</span></span><span style=display:flex><span>Sector size <span style=color:#f92672>(</span>logical/physical<span style=color:#f92672>)</span>: <span style=color:#ae81ff>512</span> bytes / <span style=color:#ae81ff>512</span> bytes
</span></span><span style=display:flex><span>I/O size <span style=color:#f92672>(</span>minimum/optimal<span style=color:#f92672>)</span>: <span style=color:#ae81ff>512</span> bytes / <span style=color:#ae81ff>512</span> bytes
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Disk /dev/mapper/docker-253:0-201326881-pool: 107.4 GB, <span style=color:#ae81ff>107374182400</span> bytes, <span style=color:#ae81ff>209715200</span> sectors
</span></span><span style=display:flex><span>Units <span style=color:#f92672>=</span> sectors of <span style=color:#ae81ff>1</span> * 512 <span style=color:#f92672>=</span> <span style=color:#ae81ff>512</span> bytes
</span></span><span style=display:flex><span>Sector size <span style=color:#f92672>(</span>logical/physical<span style=color:#f92672>)</span>: <span style=color:#ae81ff>512</span> bytes / <span style=color:#ae81ff>512</span> bytes
</span></span><span style=display:flex><span>I/O size <span style=color:#f92672>(</span>minimum/optimal<span style=color:#f92672>)</span>: <span style=color:#ae81ff>65536</span> bytes / <span style=color:#ae81ff>65536</span> bytes
</span></span></code></pre></div><p>可以看到磁盘文件 <code>/dev/sda</code>，虚拟机一般都是 <code>sd</code> 开头。</p><p><code>419430400 sectors</code> 表示磁盘 <code>/dev/sda</code> 可以分为多少个扇区。<code>Units = sectors of 1 * 512 = 512 bytes</code> 表示一个扇区的大小是 512 字节。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>   Device Boot      Start         End      Blocks   Id  System
</span></span><span style=display:flex><span>/dev/sda1   *        <span style=color:#ae81ff>2048</span>     <span style=color:#ae81ff>4147199</span>     <span style=color:#ae81ff>2072576</span>   <span style=color:#ae81ff>83</span>  Linux
</span></span></code></pre></div><p>表示 <code>/dev/sda1</code> 这个分区的大小是从第 2048 个扇区到第 4147199 扇区。<code>Boot</code> 为 <code>*</code> 表示当前的系统是在 <code>/dev/sda1</code> 这个分区启动的。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># ls -l /dev/sd?</span>
</span></span><span style=display:flex><span>brw-rw----. <span style=color:#ae81ff>1</span> root disk 8, <span style=color:#ae81ff>0</span> Jun <span style=color:#ae81ff>22</span> 10:20 /dev/sda
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># ls -l /dev/sd??</span>
</span></span><span style=display:flex><span>brw-rw----. <span style=color:#ae81ff>1</span> root disk 8, <span style=color:#ae81ff>1</span> Jun <span style=color:#ae81ff>22</span> 10:20 /dev/sda1
</span></span><span style=display:flex><span>brw-rw----. <span style=color:#ae81ff>1</span> root disk 8, <span style=color:#ae81ff>2</span> Jun <span style=color:#ae81ff>22</span> 10:20 /dev/sda2
</span></span><span style=display:flex><span>brw-rw----. <span style=color:#ae81ff>1</span> root disk 8, <span style=color:#ae81ff>3</span> Jun <span style=color:#ae81ff>22</span> 10:20 /dev/sda3
</span></span></code></pre></div><p><code>/dev/sda</code> 的类型是 <code>b</code> 也就是块设备。 <code>disk 8, 0</code> 中 8 表示<strong>主设备号</strong>（表示磁盘使用的驱动程序），0 是<strong>从设备号</strong>（确定访问地址），作为参数传给驱动程序。</p><p><code>sda1</code> <code>sda2</code> <code>sda3</code> 是磁盘 <code>sda</code> 的分区。并且它们的主设备号是相同的，也就是使用同样的块设备驱动。</p><h4 id=df-和-du>df 和 du
<a class=anchor href=#df-%e5%92%8c-du>#</a></h4><p><code>df</code> 可以看做是 <code>fdisk</code> 的补充。<code>fdisk</code> 无法看到分区挂载到了那个目录下。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># df -h</span>
</span></span><span style=display:flex><span>Filesystem             Size  Used Avail Use% Mounted on
</span></span><span style=display:flex><span>/dev/mapper/rhel-root  191G   89G  103G  47% /
</span></span><span style=display:flex><span>devtmpfs               7.8G     <span style=color:#ae81ff>0</span>  7.8G   0% /dev
</span></span><span style=display:flex><span>tmpfs                  7.8G     <span style=color:#ae81ff>0</span>  7.8G   0% /dev/shm
</span></span><span style=display:flex><span>tmpfs                  7.8G  154M  7.7G   2% /run
</span></span><span style=display:flex><span>tmpfs                  7.8G     <span style=color:#ae81ff>0</span>  7.8G   0% /sys/fs/cgroup
</span></span><span style=display:flex><span>/dev/sda1              2.0G  170M  1.9G   9% /boot
</span></span><span style=display:flex><span>tmpfs                  1.6G   12K  1.6G   1% /run/user/42
</span></span><span style=display:flex><span>tmpfs                  1.6G     <span style=color:#ae81ff>0</span>  1.6G   0% /run/user/0
</span></span></code></pre></div><p>查看一个文件的大小：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># ls -lh /etc/passwd</span>
</span></span><span style=display:flex><span>-rw-r--r--. <span style=color:#ae81ff>1</span> root root 2.3K May  <span style=color:#ae81ff>9</span>  <span style=color:#ae81ff>2018</span> /etc/passwd
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># du /etc/passwd</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>4</span> /etc/passwd
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># du -h 2019.02.0054.zip</span>
</span></span><span style=display:flex><span>1.9G 2019.02.0054.zip
</span></span></code></pre></div><p><code>du</code> 显示的实际占用的空间，默认单位是 <code>KB</code>。<code>ls -l</code> 查看的文件大小包含了部分空洞的空间。</p><h2 id=linux-常见的文件系统>Linux 常见的文件系统
<a class=anchor href=#linux-%e5%b8%b8%e8%a7%81%e7%9a%84%e6%96%87%e4%bb%b6%e7%b3%bb%e7%bb%9f>#</a></h2><ul><li>ext4（CentOS 6 默认的文件系统）</li><li>xfs（CentOS 7 默认的文件系统）</li><li>NTFS（需要版权，额外安装软件）</li></ul><h3 id=ext4>ext4
<a class=anchor href=#ext4>#</a></h3><p>基本结构：</p><ul><li>超级块，记录整个文件系统的信息，包括多少个文件等等。</li><li>超级块副本，超级块的备份，用来恢复超级块。</li><li>inode，记录每一个文件，文件名称，大小，编号，权限等。</li><li>数据块 （datablock）</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># ls -i</span>
</span></span><span style=display:flex><span> <span style=color:#ae81ff>67162193</span> anaconda-ks.cfg                          <span style=color:#ae81ff>67188932</span> metadata.tar.gz
</span></span><span style=display:flex><span> <span style=color:#ae81ff>75649215</span> app.js                                    <span style=color:#ae81ff>2773685</span> Music
</span></span><span style=display:flex><span> <span style=color:#ae81ff>73006266</span> a.sh                                     <span style=color:#ae81ff>35743888</span> newui
</span></span><span style=display:flex><span><span style=color:#ae81ff>470150081</span> cdf                                      <span style=color:#ae81ff>67362934</span> ngrok
</span></span><span style=display:flex><span><span style=color:#ae81ff>374494288</span> cdf-components                           <span style=color:#ae81ff>67362928</span> ngrok-stable-linux-amd64.zip
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>2974620</span> certificate-controller                   <span style=color:#ae81ff>73006211</span> nohup.out
</span></span><span style=display:flex><span><span style=color:#ae81ff>134217848</span> chatops-docker                          <span style=color:#ae81ff>134385344</span> offline-download
</span></span><span style=display:flex><span><span style=color:#ae81ff>101575486</span> Desktop                                  <span style=color:#ae81ff>67307785</span> offline-download.zip
</span></span><span style=display:flex><span><span style=color:#ae81ff>101575487</span> Documents                                <span style=color:#ae81ff>73006268</span> offline-download.zip.1
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>2773684</span> Downloads                                <span style=color:#ae81ff>34997822</span> Pictures
</span></span><span style=display:flex><span> <span style=color:#ae81ff>67328576</span> go1.13.3.linux-amd64.tar.gz             <span style=color:#ae81ff>470102230</span> popeye
</span></span><span style=display:flex><span><span style=color:#ae81ff>469762624</span> go-fips                                 <span style=color:#ae81ff>338000301</span> project-layout
</span></span><span style=display:flex><span> <span style=color:#ae81ff>67184332</span> go-fips.tar                              <span style=color:#ae81ff>67308300</span> Public
</span></span><span style=display:flex><span><span style=color:#ae81ff>269104077</span> golang                                   <span style=color:#ae81ff>83775905</span> renewCert
</span></span><span style=display:flex><span><span style=color:#ae81ff>436767572</span> gowork                                  <span style=color:#ae81ff>469806872</span> sactive-bot
</span></span><span style=display:flex><span><span style=color:#ae81ff>168542293</span> hawk-eye                                <span style=color:#ae81ff>373471446</span> sactive-web
</span></span></code></pre></div><p><code>ls -i</code> 可以查看每一个文件对应的 inode。文件的 inode 是不会记录文件名称的，文件名记录在父节点的 inode 中。文件的内容存储在 datablock 中。文件的读权限，就表示可以读取 datablock 中的内容。目录的读权限就表示读取目录下的文件的名称。</p><p>inode 和 datablock 的结构是链表结构。inode 是头结点。</p><h2 id=文件操作>文件操作
<a class=anchor href=#%e6%96%87%e4%bb%b6%e6%93%8d%e4%bd%9c>#</a></h2><ul><li><code>touch</code> 创建文件 <code>touch &lt;文件名></code></li><li><code>cp</code> 复制文件 <code>cp &lt;src> &lt;target></code></li><li><code>mv</code> 移动文件 <code>mv &lt;src> &lt;target></code>，如果在同一个目录中移动，那就是重命名操作，inode 并不会改变，操作非常快。如果再同一个分区移动，也会非常快，因为文件被同一个文件系统管理，只是修改 inode
的信息。</li><li><code>rm</code> 删除文件，其实就是将文件名和 inode 的链接断开。这样删除会非常快，即使文件非常大。也使误删除操作，可以恢复。</li><li><code>ln</code> 文件链接</li></ul><h3 id=修改文件>修改文件
<a class=anchor href=#%e4%bf%ae%e6%94%b9%e6%96%87%e4%bb%b6>#</a></h3><p>如果使用 <code>vim</code> 修改文件内容：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># vim test1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># ls -li test1</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>67324877</span> -rw-r--r--. <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>445</span> Aug <span style=color:#ae81ff>30</span> 15:54 test1
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># vim test1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># ls -li test1</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>67324882</span> -rw-r--r--. <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>413</span> Aug <span style=color:#ae81ff>30</span> 15:55 test1
</span></span></code></pre></div><p>inode 被改变了，67324877 变成了 67324882。vim 其实是创建了一个新的文件，使文件名指向了新的文件。</p><p>当使用 vim 修改文件时，会创建一个 swp 文件，例如 <code>test1.swp</code>，真正修改的就是这个 swp 文件。这样可以保证一致性。</p><h2 id=ln>ln
<a class=anchor href=#ln>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># ls -li test1</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>67324882</span> -rw-r--r--. <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>413</span> Aug <span style=color:#ae81ff>30</span> 15:55 test1
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># ln test1 test2</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># ls -li test1 test2</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>67324882</span> -rw-r--r--. <span style=color:#ae81ff>2</span> root root <span style=color:#ae81ff>413</span> Aug <span style=color:#ae81ff>30</span> 15:55 test1
</span></span><span style=display:flex><span><span style=color:#ae81ff>67324882</span> -rw-r--r--. <span style=color:#ae81ff>2</span> root root <span style=color:#ae81ff>413</span> Aug <span style=color:#ae81ff>30</span> 15:55 test2
</span></span></code></pre></div><p><code>67324882 -rw-r--r--. 1</code> 这里最后的 1 表示有 1 个文件名和这个 inode 建立了链接。使用 <code>ln</code> 是 test1 test2 建立了链接，指向了同一个 inode 67324882。删除时，只删除一个是不会丢失文件的。<code>ln</code> 不会占用空间，只是在父目录存储了文件名。</p><p><code>ln</code> 不能跨文件系统。因为 inode 是记录在文件系统中的。</p><h3 id=软连接>软连接
<a class=anchor href=#%e8%bd%af%e8%bf%9e%e6%8e%a5>#</a></h3><p>也叫做符号链接。使用 <code>ln -s</code> 创建软连接：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># ln -s test1 test2</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># ls -li test1 test2</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>67324882</span> -rw-r--r--. <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>413</span> Aug <span style=color:#ae81ff>30</span> 15:55 test1
</span></span><span style=display:flex><span><span style=color:#ae81ff>67324865</span> lrwxrwxrwx. <span style=color:#ae81ff>1</span> root root   <span style=color:#ae81ff>5</span> Aug <span style=color:#ae81ff>30</span> 16:09 test2 -&gt; test1
</span></span></code></pre></div><p>test1 test2 的 inode 是不一样的。test2 记录了 test1 的文件路径。类型是 <code>l</code>。</p><p><strong>软连接是可以跨文件系统的，和硬链接的区别是，会创建新的文件</strong>。</p><h3 id=facl>facl
<a class=anchor href=#facl>#</a></h3><p>如果要设置某个用户访问某个文件的权限，可以使用 <code>facl</code>。</p><ul><li>getfacl，查看文件的访问控制列表</li><li>setfacl，设置文件的访问控制</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># setfacl -m u:user1:r test1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@pooky ~<span style=color:#f92672>]</span><span style=color:#75715e># getfacl test1</span>
</span></span><span style=display:flex><span><span style=color:#75715e># file: test1</span>
</span></span><span style=display:flex><span><span style=color:#75715e># owner: root</span>
</span></span><span style=display:flex><span><span style=color:#75715e># group: root</span>
</span></span><span style=display:flex><span>user::rw-
</span></span><span style=display:flex><span>user:user1:r--
</span></span><span style=display:flex><span>group::r--
</span></span><span style=display:flex><span>mask::r--
</span></span><span style=display:flex><span>other::r--
</span></span></code></pre></div><p><code>setfacl -m u:user1:r test1</code> 表示给 user1 用户设置 test1 文件的只读权限。如果是组，把 <code>u:</code> 改成 <code>g:</code>。<code>r</code> 是只读权限。<code>rw</code> 表示读写权限。</p><ul><li><code>-m</code> 赋予权限</li><li><code>-x</code> 收回权限，<code>setfacl -x u:user1:r test1</code>。</li></ul><h2 id=分区和挂载>分区和挂载
<a class=anchor href=#%e5%88%86%e5%8c%ba%e5%92%8c%e6%8c%82%e8%bd%bd>#</a></h2><ul><li>fdisk，<code>fdisk &lt;磁盘设备></code>，如 <code>fdisk /dev/sdb</code>。</li><li>mkfs，fdisk 创建分区之后，要使用分区，需要使用 mkfs。mkfs 支持多种文件系统，如 <code>mkfs.xfs</code>，<code>mkfs.ext4</code>，<code>mkfs.ext3</code> 等等。使用对应的命令来把分区做成对应的文件系统，如 <code>mkfs.ext4 /dev/sdb1</code>，把 <code>/dev/sdb</code> 磁盘下的 <code>/dev/sdb1</code> 分区格式化为 ext4 文件系统。</li><li>mount，类似 <code>/dev/sdb1</code> 的块设备文件是不能直接操作的，需要挂载到一个目录。如 <code>mount -t ext4 /dev/sdb1 /mnt/sdb1</code>，把 <code>/dev/sdb1</code> 挂载到 <code>/mnt/sdb1</code>。<code>-t</code> 参数可以省略，mount 命令会自动检测文件系统。</li><li>parted，在硬盘大于 2 TB 时使用。使用类似 fdisk。</li></ul><h3 id=配置文件>配置文件
<a class=anchor href=#%e9%85%8d%e7%bd%ae%e6%96%87%e4%bb%b6>#</a></h3><p>上面使用命令行分区，配置是在内存中，机器重启，就会消失。需要修改配置文件： <code>/etc/fstab</code> 才能固话配置。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># /etc/fstab</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Created by anaconda on Mon Mar 18 17:53:42 2019</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Accessible filesystems, by reference, are maintained under &#39;/dev/disk&#39;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span>/dev/mapper/centos7-root /                       xfs     defaults        <span style=color:#ae81ff>0</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>UUID<span style=color:#f92672>=</span>eba30a1f-8f8b-42ee-85b3-7b17dac16e93 /boot                   xfs     defaults        <span style=color:#ae81ff>0</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#UUID=f8332d90-061a-44c4-897c-acd5a16da7e5 swap                    swap    defaults        0 0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 示例</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 要挂载的设备  要挂载的目录  文件系统  权限</span>
</span></span><span style=display:flex><span>/dev/sdb1       /mnt/sdb1    ext4     defaults  <span style=color:#ae81ff>0</span>  <span style=color:#ae81ff>0</span>
</span></span></code></pre></div><h2 id=用户磁盘配额>用户磁盘配额
<a class=anchor href=#%e7%94%a8%e6%88%b7%e7%a3%81%e7%9b%98%e9%85%8d%e9%a2%9d>#</a></h2><p><code>xfs</code> 文件系统的用户磁盘配额 quota</p><ol><li><code>mkfs.xfs /dev/sdb1</code> 格式化分区，<code>-f</code> 强制格式化。</li><li><code>mount -o uquota,gquota /dev/sdb1 /mnt/disk1</code> 挂载 <code>/dev/sdb1</code> 到 <code>/mnt/disk1</code> 目录。<code>-o uquota,gquota</code> 表示这个分区要支持用户和组磁盘配额。</li><li><code>chmod 1777 /mnt/disk1</code></li><li><code>xfs_quota -x -c 'report -ugibh' /mnt/disk1</code> 查看磁盘配额，执行 <code>report -ugibh</code>。</li><li><code>xfs_quota -x -c 'limit -u isoft=5 ihard=10 user1' /mnt/disk1</code> 限制某个用户的磁盘配额，执行 <code>limit -u isoft=5 ihard=10 user1</code>。</li></ol><h2 id=交换分区>交换分区
<a class=anchor href=#%e4%ba%a4%e6%8d%a2%e5%88%86%e5%8c%ba>#</a></h2><p>交换分区是在内存不够用时，在磁盘上开辟一块空间，来扩充内存。</p><ul><li>mkswap，<code>mkswap /dev/sdb2</code> 设置 <code>/dev/sdb2</code> 分区为 swap 的标记。</li><li>swapon，<code>swapon /dev/sdb2</code> 打开 swap 分区。可以使用 <code>free</code> 查看 swap 空间是否增加。</li><li>swapoff，<code>swapoff /dev/sdb2</code> 关闭 swap 分区。</li></ul><h3 id=使用文件方式扩充-swap>使用文件方式扩充 swap
<a class=anchor href=#%e4%bd%bf%e7%94%a8%e6%96%87%e4%bb%b6%e6%96%b9%e5%bc%8f%e6%89%a9%e5%85%85-swap>#</a></h3><ul><li><code>dd if=/dev/zero bs=4M count=1024 of=/swapfile</code>，<code>bs=4M</code> 表示 block size 为 4M，<code>count=1024</code> 表示创建 1024 个 block，<code>of=/swapfile</code> 设备文件为 <code>swapfile</code>。创建了一个大小为 <code>1024 * 4M</code> 的 swapfile。</li><li><code>mkswap /swapfile</code></li><li><code>chmod 600 /swapfile</code></li><li><code>swapon /swapfile</code></li></ul><h3 id=配置文件-fstab>配置文件 fstab
<a class=anchor href=#%e9%85%8d%e7%bd%ae%e6%96%87%e4%bb%b6-fstab>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># /etc/fstab</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Created by anaconda on Mon Mar 18 17:53:42 2019</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Accessible filesystems, by reference, are maintained under &#39;/dev/disk&#39;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span>/dev/mapper/centos7-root /                       xfs     defaults        <span style=color:#ae81ff>0</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>UUID<span style=color:#f92672>=</span>eba30a1f-8f8b-42ee-85b3-7b17dac16e93 /boot                   xfs     defaults        <span style=color:#ae81ff>0</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#UUID=f8332d90-061a-44c4-897c-acd5a16da7e5 swap                    swap    defaults        0 0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 示例</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 要挂载的设备  要挂载的目录  文件系统  权限</span>
</span></span><span style=display:flex><span>/dev/sdb1       /mnt/sdb1    ext4     defaults  <span style=color:#ae81ff>0</span>  <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 要挂载的设备  挂载的目录是虚拟的所以是swap   文件系统    权限      是否备份  是否开机自检，已经不需要</span>
</span></span><span style=display:flex><span>/swapfile       swap                         swap        defaults  <span style=color:#ae81ff>0</span>         <span style=color:#ae81ff>0</span>
</span></span></code></pre></div><h2 id=raid>RAID
<a class=anchor href=#raid>#</a></h2><p>RAID 技术就是把多块磁盘作为一个组合来使用。</p><ul><li>RAID 0 striping 条带方式，提高单盘的吞吐率。RAID 0 最好由相同容量的两块或两块以上的硬盘组成。如果组成 RAID 0 的两块硬盘大小不一致，则会影响 RAID 0 的性能。这种模式下会先把硬盘分隔出大小相等的区块，当有数据需要写入硬盘时，会把数据也切割成相同大小的区块，然后分别写入各块硬盘。这样就相当于把一个文件分成几个部分同时向不同的硬盘中写入，数据的读/写速度当然就会非常快。RAID 0 没有数据冗余功能，RAID 0 中的任何一块硬盘损坏，RAID 0 中所有的数据都将丟失。</li><li>RAID 1 mirroring 镜像方式，提高可靠性。由两块硬盘组成。两块硬盘的大小最好一致，否则总容量以容量小的那块硬盘为主。RAID 1 就具备了数据冗余功能，因为这种模式是把同一份数据同时写入两块硬盘。比如有两块硬盘，组成了 RAID 1，当有数据写入时，相同的数据既写入硬盘 1，也写入硬盘 2。这样相当于给数据做了备份。RAID 1 具有了数据冗余功能，但是硬盘的容量却减少了 50%，因为两块硬盘当中保存的数据是一样的。</li><li>RAID 5 有奇偶校验。最少需要由 3 块硬盘组成，当然硬盘的容量也应当一致。当组成 RAID 5 时，同样需要把硬盘分隔成大小相同的区块。当有数据写入时，数据也被划分成等大小的区块，然后循环向 RAID 5 中写入。每次循环写入数据的过程中，在其中一块硬盘中加入一个奇偶校验值（Parity），这个奇偶校验值的内容是这次循环写入时其他硬盘数据的备份。当有一块硬盘损坏时，采用这个奇偶校验值进行数据恢复。RAID 5，只支持一块硬盘损坏之后的数据恢复。</li><li>RAID 10 是 RAID 0 和 RAID 1 的结合。先用两块硬盘组成 RAID 1，再用两块硬盘组成另一个 RAID 1，最后把这两个 RAID 1组成 RAID 0，这种 RAID 方法称作 RAID 10。那先组成 RAID 0，再组成 RAID 1 的方法叫作 RAID 01。</li></ul><p>在服务器上实现 RAID，可以采用磁盘阵列卡（RAID 卡）来组成 RAID，也就是硬 RAID。RAID 卡上有专门的芯片负责 RAID 任务，因此性能要好得多，而且不占用系统性能，缺点是 RAID 卡比较昂贵。</p><p>软 RAID 是指通过软件实现 RAID 功能，没有多余的费用，但是会占用非常多的 CPU，而且数据的写入速度比硬 RAID 慢。</p><p>软件 RAID 需要安装 <code>mdadm</code>。</p><h2 id=逻辑卷>逻辑卷
<a class=anchor href=#%e9%80%bb%e8%be%91%e5%8d%b7>#</a></h2><p>LVM （逻辑卷管理器）是 Linux 系统用于对硬盘分区进行管理的一种机制，为了解决硬盘设备在创建分区后不易修改分区大小的缺陷。传统的硬盘分区进行强制扩容或缩容从理论上讲是可行的。但是却可能造成数据的丢失。LVM 技术是在硬盘分区和文件系统之间添加了一个逻辑层，它提供了一个抽象的卷组，可以把多块硬盘进行卷组合并。</p><p><img src=/images/lvm.png alt></p><ul><li>物理卷（PV：Physical Volume）：物理卷是底层真正提供容量，存放数据的设备，它可以是整个硬盘、硬盘上的分区等。</li><li>卷组（VG：Volume Group）：卷组建立在物理卷之上，它由一个或多个物理卷组成。即把物理卷整合起来提供容量分配。一个 LVM 系统中可以只有一个卷组，也可以包含多个卷组。</li><li>逻辑卷（LV：Logical Volume）：逻辑卷建立在卷组之上，它是从卷组中“切出”的一块空间。它是最终用户使用的逻辑设备。逻辑卷创建之后，其大小可以伸缩。</li><li>基本单元（PE：Physical Extents）：具有唯一编号的PE是能被LVM寻址的最小单元。PE 的大小可以指定，默认为 4 MB。PE 的大小一旦确定将不能改变，同一个卷组中的所有的物理卷的PE的大小是一直的</li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/shipengqi/os-learn/commit/4f49c8bc26ad1442af2b9f5753687f18dc226c1a title='Last modified by shipengqi | November 15, 2023' target=_blank rel=noopener><img src=/os-learn/svg/calendar.svg class=book-icon alt=Calendar>
<span>November 15, 2023</span></a></div><div><a class="flex align-center" href=https://github.com/shipengqi/os-learn/edit/master/content/docs/commands/12_mem_disk.md target=_blank rel=noopener><img src=/os-learn/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#内存和磁盘>内存和磁盘</a><ul><li><a href=#查看内存和磁盘的使用率>查看内存和磁盘的使用率</a><ul><li><a href=#查看内存的使用率>查看内存的使用率</a></li><li><a href=#查看磁盘的使用率>查看磁盘的使用率</a></li></ul></li><li><a href=#linux-常见的文件系统>Linux 常见的文件系统</a><ul><li><a href=#ext4>ext4</a></li></ul></li><li><a href=#文件操作>文件操作</a><ul><li><a href=#修改文件>修改文件</a></li></ul></li><li><a href=#ln>ln</a><ul><li><a href=#软连接>软连接</a></li><li><a href=#facl>facl</a></li></ul></li><li><a href=#分区和挂载>分区和挂载</a><ul><li><a href=#配置文件>配置文件</a></li></ul></li><li><a href=#用户磁盘配额>用户磁盘配额</a></li><li><a href=#交换分区>交换分区</a><ul><li><a href=#使用文件方式扩充-swap>使用文件方式扩充 swap</a></li><li><a href=#配置文件-fstab>配置文件 fstab</a></li></ul></li><li><a href=#raid>RAID</a></li><li><a href=#逻辑卷>逻辑卷</a></li></ul></li></ul></nav></div></aside></main></body></html>