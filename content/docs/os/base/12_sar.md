# 系统综合状态查询

## sar

```bash
[root@pooky ~]# sar -u 1 10
Linux 3.10.0-862.el7.x86_64 (pooky.hpeswlab.net)  09/01/2020  _x86_64_ (8 CPU)

09:06:43 PM     CPU     %user     %nice   %system   %iowait    %steal     %idle
09:06:44 PM     all      0.13      0.00      0.13      0.00      0.00     99.75
09:06:45 PM     all      0.38      0.00      0.13      0.00      0.00     99.50
09:06:46 PM     all      0.25      0.00      0.37      0.00      0.00     99.38
09:06:47 PM     all      0.13      0.00      0.00      0.00      0.00     99.87
09:06:48 PM     all      0.12      0.00      0.25      0.00      0.00     99.62
09:06:49 PM     all      0.88      0.00      0.63      0.00      0.00     98.50
09:06:50 PM     all      0.25      0.00      0.13      0.00      0.00     99.62
09:06:51 PM     all      0.25      0.00      0.13      0.00      0.00     99.62
09:06:52 PM     all      0.13      0.00      0.00      0.00      0.00     99.87
09:06:53 PM     all      0.25      0.00      0.13      0.00      0.00     99.62
Average:        all      0.28      0.00      0.19      0.00      0.00     99.54

```

- `sar -u 1 10` 中 `-u` 表示查看 cpu 状态。`1` 表示采样时间间隔，`10` 表示采样次数。
- `-r` 查看内存。
- `-b` 查看 IO。
- `-d` 查看磁盘。
- `-q` 查看进程。

## iftop

`iftop` 可以用来监控网卡的实时流量（可以指定网段）、反向解析IP、显示端口信息等。如果服务器带宽跑满了，查看跟哪个 ip 通信占用带宽比较多，可以通过 `iftop` 命令进行查询。

- TX：发送流量
- RX：接收流量
- TOTAL：总流量
- cum：运行 iftop 到目前时间的总流量
- peak：流量峰值
- rates：分别表示过去 2s 10s 40s 的平均流量

常用参数：

- `-i` 指定网卡，默认是 eth0，`iftop -i eth1`
- `-B` 以字节为单位，默认是 bit
- `-n` 显示 IP
- `-N` 显示端口
- `-F` 显示指定网段的进出流量，`iftop -F 10.10.1.0/24`，`iftop -F 10.10.1.0/255.255.255.0`
- `-p` 使用这个参数后，中间的列表显示的本地主机信息，出现了本机以外的IP信息;
- `-b` 使流量图形条默认就显示;
- `-P` 默认显示 host 和端口信息，`iftop -P`
- `-m` 设置界面最上边的刻度的最大值，刻度分五个大段显示，`iftop -m 100M`
